

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>oneCCL Concepts &mdash; oneAPI Specification 0.8 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../../../_static/favicons.png"/>
  
  
  

  
  <script type="text/javascript" src="../../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script src="../../../../_static/language_data.js"></script>
        <script src="../../../../_static/custom.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/custom.css" type="text/css" />
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="oneCCL Collective Communication" href="collective_communication.html" />
    <link rel="prev" title="Definitions" href="../definitions.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="https://oneapi.com" class="icon icon-home"> oneAPI Specification
          

          
            
            <img src="../../../../_static/oneAPI-rgb-rev-100.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.8
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../architecture.html">Software Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../library-interop.html">Library Interoperability</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../elements.html">oneAPI Elements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dpcpp/source/index.html">DPC++</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../oneDPL/source/index.html">oneDPL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../oneDNN/source/index.html">oneDNN</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">oneCCL</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../definitions.html">Definitions</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">oneCCL Concepts</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#oneccl-environment">oneCCL Environment</a></li>
<li class="toctree-l4"><a class="reference internal" href="#oneccl-stream">oneCCL Stream</a></li>
<li class="toctree-l4"><a class="reference internal" href="#oneccl-communicator">oneCCL Communicator</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="collective_communication.html">oneCCL Collective Communication</a></li>
<li class="toctree-l3"><a class="reference internal" href="error_handling.html">Error Handling</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../programming_model.html">Programming Model</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../l0/source/index.html">Level Zero</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../oneDAL/source/index.html">oneDAL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../oneTBB/source/nested-index.html">oneTBB</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../oneVPL/source/index.html">oneVPL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../oneMKL/source/index.html">oneMKL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../contributors.html">Contributors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../versions.html">HTML and PDF Versions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../notices.html">Legal Notices and Disclaimers</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">oneAPI Specification</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../index.html">oneAPI Specification</a> &raquo;</li>
        
          
          <li><a href="../index.html">oneCCL</a> </li>
          
        
          
        
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/oneapi-src/oneapi-spec/blob/master/source/elements/oneCCL/source/spec/main_objects.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="oneccl-concepts">
<h1>oneCCL Concepts<a class="headerlink" href="#oneccl-concepts" title="Permalink to this headline">¶</a></h1>
<p>oneAPI Collective Communications Library introduces the following list of concepts:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#oneccl-environment">oneCCL Environment</a></p></li>
<li><p><a class="reference internal" href="#oneccl-stream">oneCCL Stream</a></p></li>
<li><p><a class="reference internal" href="#oneccl-communicator">oneCCL Communicator</a></p></li>
</ul>
<div class="section" id="oneccl-environment">
<h2>oneCCL Environment<a class="headerlink" href="#oneccl-environment" title="Permalink to this headline">¶</a></h2>
<p>oneCCL Environment is a singleton object which is used as an entry
point into the oneCCL library and which is defined only for C++
version of API.  oneCCL Environment exposes a number of helper methods
to manage other oneCCL objects, such as streams, communicators, etc.</p>
</div>
<div class="section" id="oneccl-stream">
<h2>oneCCL Stream<a class="headerlink" href="#oneccl-stream" title="Permalink to this headline">¶</a></h2>
<p><strong>C version of oneCCL API:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">typedef</span> <span class="n">void</span><span class="o">*</span> <span class="n">ccl_stream_t</span><span class="p">;</span>
</pre></div>
</div>
<p><strong>C++ version of oneCCL API:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">stream</span><span class="p">;</span>
<span class="n">using</span> <span class="n">stream_t</span> <span class="o">=</span> <span class="n">std</span><span class="p">::</span><span class="n">unique_ptr</span><span class="o">&lt;</span><span class="n">ccl</span><span class="p">::</span><span class="n">stream</span><span class="o">&gt;</span><span class="p">;</span>
</pre></div>
</div>
<p>CCL Stream encapsulates execution context for communication primitives declared by oneCCL specification. It is an opaque handle that is managed by oneCCL API:</p>
<p><strong>C version of oneCCL API:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ccl_status_t</span> <span class="n">ccl_stream_create</span><span class="p">(</span><span class="n">ccl_stream_type_t</span> <span class="nb">type</span><span class="p">,</span>
                                    <span class="n">void</span><span class="o">*</span> <span class="n">native_stream</span><span class="p">,</span>
                                    <span class="n">ccl_stream_t</span><span class="o">*</span> <span class="n">ccl_stream</span><span class="p">);</span>
<span class="n">ccl_status_t</span> <span class="n">ccl_stream_free</span><span class="p">(</span><span class="n">ccl_stream_t</span> <span class="n">stream</span><span class="p">);</span>
</pre></div>
</div>
<p><strong>C++ version of oneCCL API:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">environment</span>
<span class="p">{</span>
<span class="n">public</span><span class="p">:</span>
<span class="o">...</span>
    <span class="o">/**</span>
    <span class="o">*</span> <span class="n">Creates</span> <span class="n">a</span> <span class="n">new</span> <span class="n">ccl</span> <span class="n">stream</span> <span class="n">of</span> <span class="nd">@c</span> <span class="nb">type</span> <span class="k">with</span> <span class="nd">@c</span> <span class="n">native</span> <span class="n">stream</span>
    <span class="o">*</span> <span class="nd">@param</span> <span class="nb">type</span> <span class="n">the</span> <span class="nd">@c</span> <span class="n">ccl</span><span class="p">::</span><span class="n">stream_type</span> <span class="ow">and</span> <span class="n">may</span> <span class="n">be</span> <span class="nd">@c</span> <span class="n">cpu</span> <span class="ow">or</span> <span class="nd">@c</span> <span class="n">sycl</span> <span class="p">(</span><span class="k">if</span> <span class="n">configured</span><span class="p">)</span>
    <span class="o">*</span> <span class="nd">@param</span> <span class="n">native_stream</span> <span class="n">the</span> <span class="n">existing</span> <span class="n">handle</span> <span class="n">of</span> <span class="n">stream</span>
    <span class="o">*/</span>
    <span class="n">stream_t</span> <span class="n">create_stream</span><span class="p">(</span><span class="n">ccl</span><span class="p">::</span><span class="n">stream_type</span> <span class="nb">type</span> <span class="o">=</span> <span class="n">ccl</span><span class="p">::</span><span class="n">stream_type</span><span class="p">::</span><span class="n">cpu</span><span class="p">,</span> <span class="n">void</span><span class="o">*</span> <span class="n">native_stream</span> <span class="o">=</span> <span class="n">nullptr</span><span class="p">)</span> <span class="n">const</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>When you create oneCCL stream object using the API described above, you need to specify the stream type and pass the pointer to the underlying command queue object.
For example, for oneAPI device you should pass <code class="docutils literal notranslate"><span class="pre">ccl::stream_type::sycl</span></code> and <code class="docutils literal notranslate"><span class="pre">cl::sycl::queue</span></code> objects.</p>
</div>
<div class="section" id="oneccl-communicator">
<h2>oneCCL Communicator<a class="headerlink" href="#oneccl-communicator" title="Permalink to this headline">¶</a></h2>
<p><strong>C version of oneCCL API:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">typedef</span> <span class="n">void</span><span class="o">*</span> <span class="n">ccl_comm_t</span><span class="p">;</span>
</pre></div>
</div>
<p><strong>C++ version of oneCCL API:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">communicator</span><span class="p">;</span>
<span class="n">using</span> <span class="n">communicator_t</span> <span class="o">=</span> <span class="n">std</span><span class="p">::</span><span class="n">unique_ptr</span><span class="o">&lt;</span><span class="n">ccl</span><span class="p">::</span><span class="n">communicator</span><span class="o">&gt;</span><span class="p">;</span>
</pre></div>
</div>
<p>oneCCL Communicator defines participants of collective communication operations. It is an opaque handle that is managed by oneCCL API:</p>
<p><strong>C version of oneCCL API:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ccl_status_t</span> <span class="n">ccl_comm_create</span><span class="p">(</span><span class="n">ccl_comm_t</span><span class="o">*</span> <span class="n">comm</span><span class="p">,</span>
                                    <span class="n">const</span> <span class="n">ccl_comm_attr_t</span><span class="o">*</span> <span class="n">attr</span><span class="p">);</span>
<span class="n">ccl_status_t</span> <span class="n">ccl_comm_free</span><span class="p">(</span><span class="n">ccl_comm_t</span> <span class="n">comm</span><span class="p">);</span>
</pre></div>
</div>
<p><strong>C++ version of oneCCL API:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">environment</span>
<span class="p">{</span>
<span class="n">public</span><span class="p">:</span>
<span class="o">...</span>
    <span class="o">/**</span>
    <span class="o">*</span> <span class="n">Creates</span> <span class="n">a</span> <span class="n">new</span> <span class="n">communicator</span> <span class="n">according</span> <span class="n">to</span> <span class="nd">@c</span> <span class="n">attr</span> <span class="n">parameters</span>
    <span class="o">*</span> <span class="ow">or</span> <span class="n">creates</span> <span class="n">a</span> <span class="n">copy</span> <span class="n">of</span> <span class="k">global</span> <span class="n">communicator</span><span class="p">,</span> <span class="k">if</span> <span class="nd">@c</span> <span class="n">attr</span> <span class="ow">is</span> <span class="nd">@c</span> <span class="n">nullptr</span><span class="p">(</span><span class="n">default</span><span class="p">)</span>
    <span class="o">*</span> <span class="nd">@param</span> <span class="n">attr</span>
    <span class="o">*/</span>
    <span class="n">communicator_t</span> <span class="n">create_communicator</span><span class="p">(</span><span class="n">const</span> <span class="n">ccl</span><span class="p">::</span><span class="n">comm_attr</span><span class="o">*</span> <span class="n">attr</span> <span class="o">=</span> <span class="n">nullptr</span><span class="p">)</span> <span class="n">const</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>When you create oneCCL Communicator, you can optionally specify attributes that control the runtime behavior of oneCCL implementation.</p>
<div class="section" id="oneccl-communicator-attributes">
<h3>oneCCL Communicator Attributes<a class="headerlink" href="#oneccl-communicator-attributes" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">typedef</span> <span class="n">struct</span>
<span class="p">{</span>
    <span class="o">/**</span>
    <span class="o">*</span> <span class="n">Used</span> <span class="n">to</span> <span class="n">split</span> <span class="k">global</span> <span class="n">communicator</span> <span class="n">into</span> <span class="n">parts</span><span class="o">.</span> <span class="n">Ranks</span> <span class="k">with</span> <span class="n">identical</span> <span class="n">color</span>
    <span class="o">*</span> <span class="n">will</span> <span class="n">form</span> <span class="n">a</span> <span class="n">new</span> <span class="n">communicator</span><span class="o">.</span>
    <span class="o">*/</span>
    <span class="nb">int</span> <span class="n">color</span><span class="p">;</span>
<span class="p">}</span> <span class="n">ccl_comm_attr_t</span><span class="p">;</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">ccl_comm_attr_t</span></code> (<code class="docutils literal notranslate"><span class="pre">ccl::comm_attr</span></code> in C++ version of API) is extendable structure that serves as a modifier of communicator behavior.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="collective_communication.html" class="btn btn-neutral float-right" title="oneCCL Collective Communication" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../definitions.html" class="btn btn-neutral float-left" title="Definitions" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Intel Corporation

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>