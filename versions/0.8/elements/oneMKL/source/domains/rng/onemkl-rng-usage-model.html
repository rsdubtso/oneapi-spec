

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>2.4.1. oneMKL RNG Usage Model &mdash; oneAPI Specification 0.8 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../../../../_static/favicons.png"/>
  
  
  

  
  <script type="text/javascript" src="../../../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../../" src="../../../../../_static/documentation_options.js"></script>
        <script src="../../../../../_static/jquery.js"></script>
        <script src="../../../../../_static/underscore.js"></script>
        <script src="../../../../../_static/doctools.js"></script>
        <script src="../../../../../_static/language_data.js"></script>
        <script src="../../../../../_static/custom.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/custom.css" type="text/css" />
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" />
    <link rel="next" title="2.4.2. Generate Routine" href="generate-routine.html" />
    <link rel="prev" title="2.3.1.7. onemkl::dft::Descriptor&lt;onemkl::dft::Precision, onemkl::dft::Domain&gt;::computeBackward&lt;typename IOType&gt;" href="../dft/mkl-dft-descriptor-mkl-dft-precision-mkl-dft-domain-computebackward-typename-iotype.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="https://oneapi.com" class="icon icon-home"> oneAPI Specification
          

          
            
            <img src="../../../../../_static/oneAPI-rgb-rev-100.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.8
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../architecture.html">Software Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../library-interop.html">Library Interoperability</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../elements.html">oneAPI Elements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../dpcpp/source/index.html">DPC++</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../oneDPL/source/index.html">oneDPL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../oneDNN/source/index.html">oneDNN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../oneCCL/source/index.html">oneCCL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../l0/source/index.html">Level Zero</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../oneDAL/source/index.html">oneDAL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../oneTBB/source/nested-index.html">oneTBB</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../oneVPL/source/index.html">oneVPL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../index.html">oneMKL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../contributors.html">Contributors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../versions.html">HTML and PDF Versions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../notices.html">Legal Notices and Disclaimers</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../index.html">oneAPI Specification</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../../index.html">oneAPI Specification</a> &raquo;</li>
        
          
          <li><a href="../../index.html">oneMKL</a> </li>
          
        
          
        
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/oneapi-src/oneapi-spec/blob/master/source/elements/oneMKL/source/domains/rng/onemkl-rng-usage-model.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="onemkl-rng-usage-model">
<span id="id1"></span><h1><span class="section-number">2.4.1. </span>oneMKL RNG Usage Model<a class="headerlink" href="#onemkl-rng-usage-model" title="Permalink to this headline">¶</a></h1>
<div class="docutils container">
<p>A typical algorithm for random number generators is as follows:</p>
<ol class="arabic simple">
<li><p>Create and initialize the object for basic random number
generator.</p>
<ul class="simple">
<li><p>Use the skip_ahead or leapfrog function if it is required (used
in parallel with random number generation for Host and CPU
devices).</p></li>
</ul>
</li>
<li><p>Create and initialize the object for distribution generator.</p></li>
<li><p>Call the generate routine to get random numbers with appropriate
statistical distribution.</p></li>
</ol>
<p>The following example demonstrates generation of random numbers that
is output of basic generator (engine) PHILOX4X32X10. The seed is
equal to 777. The generator is used to generate 10,000 normally
distributed random numbers with parameters <code class="docutils literal notranslate"><span class="pre">a</span></code> = 5 and <code class="docutils literal notranslate"><span class="pre">sigma</span></code>=
2. The purpose of the example is to calculate the sample mean for
normal distribution with the given parameters.</p>
<div class="tbstyle-tblexamplestandard docutils container">
<p class="sectiontitle rubric">Example of RNG Usage</p>
<p><strong>Buffer API</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>#include &lt;iostream&gt;
#include &lt;vector&gt;


#include “CL/sycl.hpp”
#include “mkl_rng_sycl.hpp”


int main() {
    cl::sycl::queue queue;


    const size_t n = 10000;
    std::vector&lt;double&gt; r(n);


    onemkl::rng::philox4x32x10 engine(queue, SEED); // basic random number generator object
    onemkl::rng::gaussian&lt;double, onemkl::rng::box_muller2&gt; distr(5.0, 2.0); //  distribution object


    {
         //create buffer for random numbers
         cl::sycl::buffer&lt;double, 1&gt; r_buf(r.data(), cl::sycl::range&lt;1&gt;{n});


         onemkl::rng::generate(distr, engine, n, r_buf); // perform generation


    }


    double s = 0.0;
    for(int i = 0; i &lt; n; i++) {
        s += r[i];
    }
    s /= n;


    std::cout &lt;&lt; “Average = ” &lt;&lt; s &lt;&lt; std::endl;


    return 0;
}
</pre></div>
</div>
<p><strong>USM API</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>#include &lt;iostream&gt;
#include &lt;vector&gt;
#include “CL/sycl.hpp”
#include “mkl_rng_sycl.hpp”


int main() {
  cl::sycl::queue queue;


  const size_t n = 10000;


  // create USM allocator
  cl::sycl::usm_allocator&lt;double, cl::sycl::usm::alloc::shared&gt; allocator(queue.get_context(), queue.get_device());


  // create vector woth USM allocator
  std::vector&lt;double, cl::sycl::usm_allocator&lt;double, cl::sycl::usm::alloc::shared&gt;&gt; r(n, allocator);


  onemkl::rng::philox4x32x10 engine(queue, SEED); // basic random number generator object
  onemkl::rng::gaussian&lt;double, onemkl::rng::box_muller2&gt; distr(5.0, 2.0); // distribution object


  auto event = onemkl::rng::generate(distr, engine, n, r.data()); // perform generation
  // cl::sycl::event object is returned by generate function for synchronisation
  event.wait(); // synchronization can be also done by queue.wait()


  double s = 0.0;
  for(int i = 0; i &lt; n; i++) {
  s += r[i];


  std::cout &lt;&lt; “Average = ” &lt;&lt; s &lt;&lt; std::endl;


  return 0;
}
</pre></div>
</div>
<p>You can also use USM with raw pointers by using the
cl::sycl::malloc_shared function.</p>
<p><strong>Parent topic:</strong> <a class="reference internal" href="../domains.html#onemkl-rng"><span class="std std-ref">Random Number Generators</span></a></p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="generate-routine.html" class="btn btn-neutral float-right" title="2.4.2. Generate Routine" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../dft/mkl-dft-descriptor-mkl-dft-precision-mkl-dft-domain-computebackward-typename-iotype.html" class="btn btn-neutral float-left" title="2.3.1.7. onemkl::dft::Descriptor&lt;onemkl::dft::Precision, onemkl::dft::Domain&gt;::computeBackward&lt;typename IOType&gt;" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Intel Corporation

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>