

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Inner Product &mdash; oneAPI Specification 0.8 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../../../_static/favicons.png"/>
  
  
  

  
  <script type="text/javascript" src="../../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script src="../../../../_static/language_data.js"></script>
        <script src="../../../../_static/custom.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/custom.css" type="text/css" />
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Layer normalization" href="layer_normalization.html" />
    <link rel="prev" title="Elementwise" href="eltwise.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="https://oneapi.com" class="icon icon-home"> oneAPI Specification
          

          
            
            <img src="../../../../_static/oneAPI-rgb-rev-100.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.8
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../architecture.html">Software Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../library-interop.html">Library Interoperability</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../elements.html">oneAPI Elements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dpcpp/source/index.html">DPC++</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../oneDPL/source/index.html">oneDPL</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">oneDNN</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../conventions.html">Conventions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../execution_model/index.html">Execution Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data_model/index.html">Data model</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Primitives</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="general.html">Common Definitions</a></li>
<li class="toctree-l3"><a class="reference internal" href="attributes/index.html">Attributes</a></li>
<li class="toctree-l3"><a class="reference internal" href="batch_normalization.html">Batch Normalization</a></li>
<li class="toctree-l3"><a class="reference internal" href="binary.html">Binary</a></li>
<li class="toctree-l3"><a class="reference internal" href="concat.html">Concat</a></li>
<li class="toctree-l3"><a class="reference internal" href="convolution.html">Convolution and Deconvolution</a></li>
<li class="toctree-l3"><a class="reference internal" href="eltwise.html">Elementwise</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Inner Product</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#forward">Forward</a></li>
<li class="toctree-l4"><a class="reference internal" href="#backward">Backward</a></li>
<li class="toctree-l4"><a class="reference internal" href="#operation-details">Operation Details</a></li>
<li class="toctree-l4"><a class="reference internal" href="#data-types-support">Data Types Support</a></li>
<li class="toctree-l4"><a class="reference internal" href="#data-representation">Data Representation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#post-ops-and-attributes">Post-ops and Attributes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#api">API</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="layer_normalization.html">Layer normalization</a></li>
<li class="toctree-l3"><a class="reference internal" href="logsoftmax.html">LogSoftmax</a></li>
<li class="toctree-l3"><a class="reference internal" href="lrn.html">Local Response Normalization</a></li>
<li class="toctree-l3"><a class="reference internal" href="matmul.html">Matrix Multiplication</a></li>
<li class="toctree-l3"><a class="reference internal" href="pooling.html">Pooling</a></li>
<li class="toctree-l3"><a class="reference internal" href="reorder.html">Reorder</a></li>
<li class="toctree-l3"><a class="reference internal" href="resampling.html">Resampling</a></li>
<li class="toctree-l3"><a class="reference internal" href="rnn.html">RNN</a></li>
<li class="toctree-l3"><a class="reference internal" href="shuffle.html">Shuffle</a></li>
<li class="toctree-l3"><a class="reference internal" href="softmax.html">Softmax</a></li>
<li class="toctree-l3"><a class="reference internal" href="sum.html">Sum</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#id1">Open Source Implementation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#implementation-notes">Implementation Notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#testing">Testing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../oneCCL/source/index.html">oneCCL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../l0/source/index.html">Level Zero</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../oneDAL/source/index.html">oneDAL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../oneTBB/source/nested-index.html">oneTBB</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../oneVPL/source/index.html">oneVPL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../oneMKL/source/index.html">oneMKL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../contributors.html">Contributors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../versions.html">HTML and PDF Versions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../notices.html">Legal Notices and Disclaimers</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">oneAPI Specification</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../index.html">oneAPI Specification</a> &raquo;</li>
        
          
          <li><a href="../index.html">oneDNN</a> </li>
          
        
          
        
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/oneapi-src/oneapi-spec/blob/master/source/elements/oneDNN/source/primitives/inner-product.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="inner-product">
<span id="inner-product-label"></span><h1>Inner Product<a class="headerlink" href="#inner-product" title="Permalink to this headline">¶</a></h1>
<p>The inner product primitive (sometimes called <em>fully connected layer</em>) treats
each activation in the minibatch as a vector and computes its product with a
weights 2D tensor producing a 2D tensor as an output.</p>
<div class="section" id="forward">
<h2>Forward<a class="headerlink" href="#forward" title="Permalink to this headline">¶</a></h2>
<p>Let <span class="math notranslate nohighlight">\(\src\)</span>, <span class="math notranslate nohighlight">\(\weights\)</span>, <span class="math notranslate nohighlight">\(\bias\)</span> and <span class="math notranslate nohighlight">\(\dst\)</span> be <span class="math notranslate nohighlight">\(N
\times IC\)</span>, <span class="math notranslate nohighlight">\(OC \times IC\)</span>, <span class="math notranslate nohighlight">\(OC\)</span>, and <span class="math notranslate nohighlight">\(N \times OC\)</span> tensors,
respectively. Variable names follow the standard <a class="reference internal" href="../conventions.html#conventions-label"><span class="std std-ref">Conventions</span></a>.
Then:</p>
<div class="math notranslate nohighlight">
\[\dst(n, oc) = \bias(oc) + \sum_{ic=0}^{IC-1} \src(n, ic) \cdot \weights(oc, ic)\]</div>
<p>In cases where the <span class="math notranslate nohighlight">\(\src\)</span> and <span class="math notranslate nohighlight">\(\weights\)</span> tensors have spatial dimensions, they are flattened to 2D. For example, if they are 4D <span class="math notranslate nohighlight">\(N \times IC' \times IH \times IW\)</span> and <span class="math notranslate nohighlight">\(OC \times IC' \times KH \times KW\)</span> tensors, then the formula above is applied with <span class="math notranslate nohighlight">\(IC = IC' \cdot IH \cdot IW\)</span>. In such cases, the <span class="math notranslate nohighlight">\(\src\)</span> and <span class="math notranslate nohighlight">\(\weights\)</span> tensors must have equal spatial dimensions (e.g. <span class="math notranslate nohighlight">\(KH = IH\)</span> and <span class="math notranslate nohighlight">\(KW = IW\)</span> for 4D tensors).</p>
<div class="section" id="difference-between-forward-training-and-forward-inference">
<h3>Difference Between Forward Training and Forward Inference<a class="headerlink" href="#difference-between-forward-training-and-forward-inference" title="Permalink to this headline">¶</a></h3>
<p>There is no difference between the <a class="reference internal" href="general.html#_CPPv4N4dnnl9prop_kind16forward_trainingE" title="dnnl::prop_kind::forward_training"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">forward_training</span></code></a> and <a class="reference internal" href="general.html#_CPPv4N4dnnl9prop_kind17forward_inferenceE" title="dnnl::prop_kind::forward_inference"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">forward_inference</span></code></a>
propagation kinds.</p>
</div>
</div>
<div class="section" id="backward">
<h2>Backward<a class="headerlink" href="#backward" title="Permalink to this headline">¶</a></h2>
<p>The backward propagation computes <span class="math notranslate nohighlight">\(\diffsrc\)</span> based on <span class="math notranslate nohighlight">\(\diffdst\)</span>
and <span class="math notranslate nohighlight">\(\weights\)</span>.</p>
<p>The weights update computes <span class="math notranslate nohighlight">\(\diffweights\)</span> and <span class="math notranslate nohighlight">\(\diffbias\)</span> based
on <span class="math notranslate nohighlight">\(\diffdst\)</span> and <span class="math notranslate nohighlight">\(\src\)</span>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <em>optimized</em> memory formats <span class="math notranslate nohighlight">\(\src\)</span> and <span class="math notranslate nohighlight">\(\weights\)</span> might be
different on forward propagation, backward propagation, and weights update.</p>
</div>
<div class="section" id="execution-arguments">
<h3>Execution Arguments<a class="headerlink" href="#execution-arguments" title="Permalink to this headline">¶</a></h3>
<p>When executed, the inputs and outputs should be mapped to an execution
argument index as specified by the following table.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 51%" />
<col style="width: 49%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Primitive input/output</p></th>
<th class="head"><p>Execution argument index</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\src\)</span></p></td>
<td><p><a class="reference internal" href="general.html#c.DNNL_ARG_SRC" title="DNNL_ARG_SRC"><code class="xref c c-macro docutils literal notranslate"><span class="pre">DNNL_ARG_SRC</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\weights\)</span></p></td>
<td><p><a class="reference internal" href="general.html#c.DNNL_ARG_WEIGHTS" title="DNNL_ARG_WEIGHTS"><code class="xref c c-macro docutils literal notranslate"><span class="pre">DNNL_ARG_WEIGHTS</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\bias\)</span></p></td>
<td><p><a class="reference internal" href="general.html#c.DNNL_ARG_BIAS" title="DNNL_ARG_BIAS"><code class="xref c c-macro docutils literal notranslate"><span class="pre">DNNL_ARG_BIAS</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\dst\)</span></p></td>
<td><p><a class="reference internal" href="general.html#c.DNNL_ARG_DST" title="DNNL_ARG_DST"><code class="xref c c-macro docutils literal notranslate"><span class="pre">DNNL_ARG_DST</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\diffsrc\)</span></p></td>
<td><p><a class="reference internal" href="general.html#c.DNNL_ARG_DIFF_SRC" title="DNNL_ARG_DIFF_SRC"><code class="xref c c-macro docutils literal notranslate"><span class="pre">DNNL_ARG_DIFF_SRC</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\diffweights\)</span></p></td>
<td><p><a class="reference internal" href="general.html#c.DNNL_ARG_DIFF_WEIGHTS" title="DNNL_ARG_DIFF_WEIGHTS"><code class="xref c c-macro docutils literal notranslate"><span class="pre">DNNL_ARG_DIFF_WEIGHTS</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\diffbias\)</span></p></td>
<td><p><a class="reference internal" href="general.html#c.DNNL_ARG_DIFF_BIAS" title="DNNL_ARG_DIFF_BIAS"><code class="xref c c-macro docutils literal notranslate"><span class="pre">DNNL_ARG_DIFF_BIAS</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\diffdst\)</span></p></td>
<td><p><a class="reference internal" href="general.html#c.DNNL_ARG_DIFF_DST" title="DNNL_ARG_DIFF_DST"><code class="xref c c-macro docutils literal notranslate"><span class="pre">DNNL_ARG_DIFF_DST</span></code></a></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="operation-details">
<h2>Operation Details<a class="headerlink" href="#operation-details" title="Permalink to this headline">¶</a></h2>
<p>N/A</p>
</div>
<div class="section" id="data-types-support">
<h2>Data Types Support<a class="headerlink" href="#data-types-support" title="Permalink to this headline">¶</a></h2>
<p>Inner product primitive supports the following combination of data types for
source, destination, weights, and bias.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Here we abbreviate data types names for readability. For example, <a class="reference internal" href="../data_model/data_types/index.html#_CPPv4N4dnnl6memory9data_type3f32E" title="dnnl::memory::data_type::f32"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">dnnl::memory::data_type::f32</span></code></a> is
abbreviated to <a class="reference internal" href="../data_model/data_types/index.html#_CPPv4N4dnnl6memory9data_type3f32E" title="dnnl::memory::data_type::f32"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">f32</span></code></a>.</p>
</div>
<table class="docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 14%" />
<col style="width: 14%" />
<col style="width: 26%" />
<col style="width: 26%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Propagation</p></th>
<th class="head"><p>Source</p></th>
<th class="head"><p>Weights</p></th>
<th class="head"><p>Destination</p></th>
<th class="head"><p>Bias</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>forward / backward</p></td>
<td><p><a class="reference internal" href="../data_model/data_types/index.html#_CPPv4N4dnnl6memory9data_type3f32E" title="dnnl::memory::data_type::f32"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">f32</span></code></a></p></td>
<td><p><a class="reference internal" href="../data_model/data_types/index.html#_CPPv4N4dnnl6memory9data_type3f32E" title="dnnl::memory::data_type::f32"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">f32</span></code></a></p></td>
<td><p><a class="reference internal" href="../data_model/data_types/index.html#_CPPv4N4dnnl6memory9data_type3f32E" title="dnnl::memory::data_type::f32"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">f32</span></code></a></p></td>
<td><p><a class="reference internal" href="../data_model/data_types/index.html#_CPPv4N4dnnl6memory9data_type3f32E" title="dnnl::memory::data_type::f32"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">f32</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>forward</p></td>
<td><p><a class="reference internal" href="../data_model/data_types/index.html#_CPPv4N4dnnl6memory9data_type3f16E" title="dnnl::memory::data_type::f16"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">f16</span></code></a></p></td>
<td><p><a class="reference internal" href="../data_model/data_types/index.html#_CPPv4N4dnnl6memory9data_type3f16E" title="dnnl::memory::data_type::f16"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">f16</span></code></a></p></td>
<td><p><a class="reference internal" href="../data_model/data_types/index.html#_CPPv4N4dnnl6memory9data_type3f16E" title="dnnl::memory::data_type::f16"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">f16</span></code></a></p></td>
<td><p><a class="reference internal" href="../data_model/data_types/index.html#_CPPv4N4dnnl6memory9data_type3f16E" title="dnnl::memory::data_type::f16"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">f16</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p>forward</p></td>
<td><p><a class="reference internal" href="../data_model/data_types/index.html#_CPPv4N4dnnl6memory9data_type2u8E" title="dnnl::memory::data_type::u8"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">u8</span></code></a>, <a class="reference internal" href="../data_model/data_types/index.html#_CPPv4N4dnnl6memory9data_type2s8E" title="dnnl::memory::data_type::s8"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">s8</span></code></a></p></td>
<td><p><a class="reference internal" href="../data_model/data_types/index.html#_CPPv4N4dnnl6memory9data_type2s8E" title="dnnl::memory::data_type::s8"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">s8</span></code></a></p></td>
<td><p><a class="reference internal" href="../data_model/data_types/index.html#_CPPv4N4dnnl6memory9data_type2u8E" title="dnnl::memory::data_type::u8"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">u8</span></code></a>, <a class="reference internal" href="../data_model/data_types/index.html#_CPPv4N4dnnl6memory9data_type2s8E" title="dnnl::memory::data_type::s8"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">s8</span></code></a>, <a class="reference internal" href="../data_model/data_types/index.html#_CPPv4N4dnnl6memory9data_type3s32E" title="dnnl::memory::data_type::s32"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">s32</span></code></a>, <a class="reference internal" href="../data_model/data_types/index.html#_CPPv4N4dnnl6memory9data_type3f32E" title="dnnl::memory::data_type::f32"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">f32</span></code></a></p></td>
<td><p><a class="reference internal" href="../data_model/data_types/index.html#_CPPv4N4dnnl6memory9data_type2u8E" title="dnnl::memory::data_type::u8"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">u8</span></code></a>, <a class="reference internal" href="../data_model/data_types/index.html#_CPPv4N4dnnl6memory9data_type2s8E" title="dnnl::memory::data_type::s8"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">s8</span></code></a>, <a class="reference internal" href="../data_model/data_types/index.html#_CPPv4N4dnnl6memory9data_type3s32E" title="dnnl::memory::data_type::s32"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">s32</span></code></a>, <a class="reference internal" href="../data_model/data_types/index.html#_CPPv4N4dnnl6memory9data_type3f32E" title="dnnl::memory::data_type::f32"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">f32</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>forward</p></td>
<td><p><a class="reference internal" href="../data_model/data_types/index.html#_CPPv4N4dnnl6memory9data_type4bf16E" title="dnnl::memory::data_type::bf16"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">bf16</span></code></a></p></td>
<td><p><a class="reference internal" href="../data_model/data_types/index.html#_CPPv4N4dnnl6memory9data_type4bf16E" title="dnnl::memory::data_type::bf16"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">bf16</span></code></a></p></td>
<td><p><a class="reference internal" href="../data_model/data_types/index.html#_CPPv4N4dnnl6memory9data_type3f32E" title="dnnl::memory::data_type::f32"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">f32</span></code></a>, <a class="reference internal" href="../data_model/data_types/index.html#_CPPv4N4dnnl6memory9data_type4bf16E" title="dnnl::memory::data_type::bf16"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">bf16</span></code></a></p></td>
<td><p><a class="reference internal" href="../data_model/data_types/index.html#_CPPv4N4dnnl6memory9data_type3f32E" title="dnnl::memory::data_type::f32"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">f32</span></code></a>, <a class="reference internal" href="../data_model/data_types/index.html#_CPPv4N4dnnl6memory9data_type4bf16E" title="dnnl::memory::data_type::bf16"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">bf16</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p>backward</p></td>
<td><p><a class="reference internal" href="../data_model/data_types/index.html#_CPPv4N4dnnl6memory9data_type3f32E" title="dnnl::memory::data_type::f32"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">f32</span></code></a>, <a class="reference internal" href="../data_model/data_types/index.html#_CPPv4N4dnnl6memory9data_type4bf16E" title="dnnl::memory::data_type::bf16"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">bf16</span></code></a></p></td>
<td><p><a class="reference internal" href="../data_model/data_types/index.html#_CPPv4N4dnnl6memory9data_type4bf16E" title="dnnl::memory::data_type::bf16"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">bf16</span></code></a></p></td>
<td><p><a class="reference internal" href="../data_model/data_types/index.html#_CPPv4N4dnnl6memory9data_type4bf16E" title="dnnl::memory::data_type::bf16"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">bf16</span></code></a></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>weights update</p></td>
<td><p><a class="reference internal" href="../data_model/data_types/index.html#_CPPv4N4dnnl6memory9data_type4bf16E" title="dnnl::memory::data_type::bf16"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">bf16</span></code></a></p></td>
<td><p><a class="reference internal" href="../data_model/data_types/index.html#_CPPv4N4dnnl6memory9data_type3f32E" title="dnnl::memory::data_type::f32"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">f32</span></code></a>, <a class="reference internal" href="../data_model/data_types/index.html#_CPPv4N4dnnl6memory9data_type4bf16E" title="dnnl::memory::data_type::bf16"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">bf16</span></code></a></p></td>
<td><p><a class="reference internal" href="../data_model/data_types/index.html#_CPPv4N4dnnl6memory9data_type4bf16E" title="dnnl::memory::data_type::bf16"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">bf16</span></code></a></p></td>
<td><p><a class="reference internal" href="../data_model/data_types/index.html#_CPPv4N4dnnl6memory9data_type3f32E" title="dnnl::memory::data_type::f32"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">f32</span></code></a>, <a class="reference internal" href="../data_model/data_types/index.html#_CPPv4N4dnnl6memory9data_type4bf16E" title="dnnl::memory::data_type::bf16"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">bf16</span></code></a></p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="data-representation">
<h2>Data Representation<a class="headerlink" href="#data-representation" title="Permalink to this headline">¶</a></h2>
<p>Like other CNN primitives, the inner product primitive expects the following
tensors:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 7%" />
<col style="width: 37%" />
<col style="width: 16%" />
<col style="width: 41%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Spatial</p></th>
<th class="head"><p>Source</p></th>
<th class="head"><p>Destination</p></th>
<th class="head"><p>Weights</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1D</p></td>
<td><p><span class="math notranslate nohighlight">\(N \times C \times W\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(N \times C\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(OC \times IC \times KW\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>2D</p></td>
<td><p><span class="math notranslate nohighlight">\(N \times C \times H \times W\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(N \times C\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(OC \times IC \times KH \times KW\)</span></p></td>
</tr>
<tr class="row-even"><td><p>3D</p></td>
<td><p><span class="math notranslate nohighlight">\(N \times C \times D \times H \times W\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(N \times C\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(OC \times IC \times KD \times KH \times KW\)</span></p></td>
</tr>
</tbody>
</table>
<p>Memory format of data and weights memory objects is critical for inner product
primitive performance. In the oneDNN programming model, inner product
primitive is one of the few primitives that support the placeholder format
<a class="reference internal" href="../data_model/memory/formats.html#_CPPv4N4dnnl6memory10format_tag3anyE" title="dnnl::memory::format_tag::any"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">any</span></code></a> and can define data and weight memory objects formats based on the
primitive parameters. When using <a class="reference internal" href="../data_model/memory/formats.html#_CPPv4N4dnnl6memory10format_tag3anyE" title="dnnl::memory::format_tag::any"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">any</span></code></a> it is necessary to first create an
inner product primitive descriptor and then query it for the actual data and
weight memory objects formats.</p>
<p>The table below shows the combinations for which <strong>plain</strong> memory formats the
inner product primitive is optimized for. For the destination tensor (which is
always <span class="math notranslate nohighlight">\(N \times C\)</span>) the memory format is always <a class="reference internal" href="../data_model/memory/formats.html#_CPPv4N4dnnl6memory10format_tag2ncE" title="dnnl::memory::format_tag::nc"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">nc</span></code></a> (<a class="reference internal" href="../data_model/memory/formats.html#_CPPv4N4dnnl6memory10format_tag2abE" title="dnnl::memory::format_tag::ab"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">ab</span></code></a>).</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 38%" />
<col style="width: 52%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Spatial</p></th>
<th class="head"><p>Source / Weights logical tensor</p></th>
<th class="head"><p>Implementation optimized for memory formats</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0D</p></td>
<td><p>NC / OI</p></td>
<td><p><a class="reference internal" href="../data_model/memory/formats.html#_CPPv4N4dnnl6memory10format_tag2ncE" title="dnnl::memory::format_tag::nc"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">nc</span></code></a> (<a class="reference internal" href="../data_model/memory/formats.html#_CPPv4N4dnnl6memory10format_tag2abE" title="dnnl::memory::format_tag::ab"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">ab</span></code></a>) / <a class="reference internal" href="../data_model/memory/formats.html#_CPPv4N4dnnl6memory10format_tag2oiE" title="dnnl::memory::format_tag::oi"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">oi</span></code></a> (<a class="reference internal" href="../data_model/memory/formats.html#_CPPv4N4dnnl6memory10format_tag2abE" title="dnnl::memory::format_tag::ab"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">ab</span></code></a>)</p></td>
</tr>
<tr class="row-odd"><td><p>0D</p></td>
<td><p>NC / OI</p></td>
<td><p><a class="reference internal" href="../data_model/memory/formats.html#_CPPv4N4dnnl6memory10format_tag2ncE" title="dnnl::memory::format_tag::nc"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">nc</span></code></a> (<a class="reference internal" href="../data_model/memory/formats.html#_CPPv4N4dnnl6memory10format_tag2abE" title="dnnl::memory::format_tag::ab"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">ab</span></code></a>) / <a class="reference internal" href="../data_model/memory/formats.html#_CPPv4N4dnnl6memory10format_tag2ioE" title="dnnl::memory::format_tag::io"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">io</span></code></a> (<a class="reference internal" href="../data_model/memory/formats.html#_CPPv4N4dnnl6memory10format_tag2baE" title="dnnl::memory::format_tag::ba"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">ba</span></code></a>)</p></td>
</tr>
<tr class="row-even"><td><p>1D</p></td>
<td><p>NCW / OIW</p></td>
<td><p><a class="reference internal" href="../data_model/memory/formats.html#_CPPv4N4dnnl6memory10format_tag3ncwE" title="dnnl::memory::format_tag::ncw"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">ncw</span></code></a> (<a class="reference internal" href="../data_model/memory/formats.html#_CPPv4N4dnnl6memory10format_tag3abcE" title="dnnl::memory::format_tag::abc"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">abc</span></code></a>) / <a class="reference internal" href="../data_model/memory/formats.html#_CPPv4N4dnnl6memory10format_tag3oiwE" title="dnnl::memory::format_tag::oiw"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">oiw</span></code></a> (<a class="reference internal" href="../data_model/memory/formats.html#_CPPv4N4dnnl6memory10format_tag3abcE" title="dnnl::memory::format_tag::abc"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">abc</span></code></a>)</p></td>
</tr>
<tr class="row-odd"><td><p>1D</p></td>
<td><p>NCW / OIW</p></td>
<td><p><a class="reference internal" href="../data_model/memory/formats.html#_CPPv4N4dnnl6memory10format_tag3nwcE" title="dnnl::memory::format_tag::nwc"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">nwc</span></code></a> (<a class="reference internal" href="../data_model/memory/formats.html#_CPPv4N4dnnl6memory10format_tag3acbE" title="dnnl::memory::format_tag::acb"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">acb</span></code></a>) / <a class="reference internal" href="../data_model/memory/formats.html#_CPPv4N4dnnl6memory10format_tag3wioE" title="dnnl::memory::format_tag::wio"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">wio</span></code></a> (<a class="reference internal" href="../data_model/memory/formats.html#_CPPv4N4dnnl6memory10format_tag3cbaE" title="dnnl::memory::format_tag::cba"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">cba</span></code></a>)</p></td>
</tr>
<tr class="row-even"><td><p>2D</p></td>
<td><p>NCHW / OIHW</p></td>
<td><p><a class="reference internal" href="../data_model/memory/formats.html#_CPPv4N4dnnl6memory10format_tag4nchwE" title="dnnl::memory::format_tag::nchw"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">nchw</span></code></a> (<a class="reference internal" href="../data_model/memory/formats.html#_CPPv4N4dnnl6memory10format_tag4abcdE" title="dnnl::memory::format_tag::abcd"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">abcd</span></code></a>) / <a class="reference internal" href="../data_model/memory/formats.html#_CPPv4N4dnnl6memory10format_tag4oihwE" title="dnnl::memory::format_tag::oihw"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">oihw</span></code></a> (<a class="reference internal" href="../data_model/memory/formats.html#_CPPv4N4dnnl6memory10format_tag4abcdE" title="dnnl::memory::format_tag::abcd"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">abcd</span></code></a>)</p></td>
</tr>
<tr class="row-odd"><td><p>2D</p></td>
<td><p>NCHW / OIHW</p></td>
<td><p><a class="reference internal" href="../data_model/memory/formats.html#_CPPv4N4dnnl6memory10format_tag4nhwcE" title="dnnl::memory::format_tag::nhwc"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">nhwc</span></code></a> (<a class="reference internal" href="../data_model/memory/formats.html#_CPPv4N4dnnl6memory10format_tag4acdbE" title="dnnl::memory::format_tag::acdb"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">acdb</span></code></a>) / <a class="reference internal" href="../data_model/memory/formats.html#_CPPv4N4dnnl6memory10format_tag4hwioE" title="dnnl::memory::format_tag::hwio"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">hwio</span></code></a> (<a class="reference internal" href="../data_model/memory/formats.html#_CPPv4N4dnnl6memory10format_tag4cdbaE" title="dnnl::memory::format_tag::cdba"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">cdba</span></code></a>)</p></td>
</tr>
<tr class="row-even"><td><p>3D</p></td>
<td><p>NCDHW / OIDHW</p></td>
<td><p><a class="reference internal" href="../data_model/memory/formats.html#_CPPv4N4dnnl6memory10format_tag5ncdhwE" title="dnnl::memory::format_tag::ncdhw"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">ncdhw</span></code></a> (<a class="reference internal" href="../data_model/memory/formats.html#_CPPv4N4dnnl6memory10format_tag5abcdeE" title="dnnl::memory::format_tag::abcde"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">abcde</span></code></a>) / <a class="reference internal" href="../data_model/memory/formats.html#_CPPv4N4dnnl6memory10format_tag5oidhwE" title="dnnl::memory::format_tag::oidhw"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">oidhw</span></code></a> (<a class="reference internal" href="../data_model/memory/formats.html#_CPPv4N4dnnl6memory10format_tag5abcdeE" title="dnnl::memory::format_tag::abcde"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">abcde</span></code></a>)</p></td>
</tr>
<tr class="row-odd"><td><p>3D</p></td>
<td><p>NCDHW / OIDHW</p></td>
<td><p><a class="reference internal" href="../data_model/memory/formats.html#_CPPv4N4dnnl6memory10format_tag5ndhwcE" title="dnnl::memory::format_tag::ndhwc"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">ndhwc</span></code></a> (<a class="reference internal" href="../data_model/memory/formats.html#_CPPv4N4dnnl6memory10format_tag5acdebE" title="dnnl::memory::format_tag::acdeb"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">acdeb</span></code></a>) / <a class="reference internal" href="../data_model/memory/formats.html#_CPPv4N4dnnl6memory10format_tag5dhwioE" title="dnnl::memory::format_tag::dhwio"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">dhwio</span></code></a> (<a class="reference internal" href="../data_model/memory/formats.html#_CPPv4N4dnnl6memory10format_tag5cdebaE" title="dnnl::memory::format_tag::cdeba"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">cdeba</span></code></a>)</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="post-ops-and-attributes">
<h2>Post-ops and Attributes<a class="headerlink" href="#post-ops-and-attributes" title="Permalink to this headline">¶</a></h2>
<p>The following post-ops should be supported by inner product primitives:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 7%" />
<col style="width: 6%" />
<col style="width: 33%" />
<col style="width: 41%" />
<col style="width: 14%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Propagation</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Operation</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Restrictions</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>forward</p></td>
<td><p>attribute</p></td>
<td><p><a class="reference internal" href="attributes/index.html#_CPPv4N4dnnl14primitive_attr17set_output_scalesEiRKNSt6vectorIfEE" title="dnnl::primitive_attr::set_output_scales"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">Output</span> <span class="pre">scale</span></code></a></p></td>
<td><p>Scales the result of inner product by given scale factor(s)</p></td>
<td><p>int8 inner products only</p></td>
</tr>
<tr class="row-odd"><td><p>forward</p></td>
<td><p>post-op</p></td>
<td><p><a class="reference internal" href="attributes/post-ops.html#_CPPv4N4dnnl8post_ops14append_eltwiseEf9algorithmff" title="dnnl::post_ops::append_eltwise"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">Eltwise</span></code></a></p></td>
<td><p>Applies an elementwise operation to the result</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>forward</p></td>
<td><p>post-op</p></td>
<td><p><a class="reference internal" href="attributes/post-ops.html#_CPPv4N4dnnl8post_ops10append_sumEf" title="dnnl::post_ops::append_sum"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">Sum</span></code></a></p></td>
<td><p>Adds the operation result to the destination tensor instead of overwriting it</p></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="api">
<h2>API<a class="headerlink" href="#api" title="Permalink to this headline">¶</a></h2>
<dl class="cpp struct">
<dt id="_CPPv4N4dnnl21inner_product_forwardE">
<span id="_CPPv3N4dnnl21inner_product_forwardE"></span><span id="_CPPv2N4dnnl21inner_product_forwardE"></span><span id="dnnl::inner_product_forward"></span><span class="target" id="structdnnl_1_1inner__product__forward"></span><em class="property">struct </em><code class="sig-prename descclassname">dnnl<code class="sig-prename descclassname">::</code></code><code class="sig-name descname">inner_product_forward</code> : <em class="property">public</em> dnnl::<a class="reference internal" href="general.html#_CPPv4N4dnnl9primitiveE" title="dnnl::primitive">primitive</a><a class="headerlink" href="#_CPPv4N4dnnl21inner_product_forwardE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Inner product forward propagation primitive. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="cpp function">
<dt id="_CPPv4N4dnnl21inner_product_forward21inner_product_forwardEv">
<span id="_CPPv3N4dnnl21inner_product_forward21inner_product_forwardEv"></span><span id="_CPPv2N4dnnl21inner_product_forward21inner_product_forwardEv"></span><span id="dnnl::inner_product_forward::inner_product_forward"></span><span class="target" id="structdnnl_1_1inner__product__forward_1a51dcac732c17bbe0e44e90e6f6afbb21"></span><code class="sig-name descname">inner_product_forward</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4dnnl21inner_product_forward21inner_product_forwardEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Default constructor. Produces an empty object. </p>
</dd></dl>

<dl class="cpp function">
<dt id="_CPPv4N4dnnl21inner_product_forward21inner_product_forwardERK14primitive_desc">
<span id="_CPPv3N4dnnl21inner_product_forward21inner_product_forwardERK14primitive_desc"></span><span id="_CPPv2N4dnnl21inner_product_forward21inner_product_forwardERK14primitive_desc"></span><span id="dnnl::inner_product_forward::inner_product_forward__primitive_descCR"></span><span class="target" id="structdnnl_1_1inner__product__forward_1a1626abb1c2dc58648dc6271cebb31a14"></span><code class="sig-name descname">inner_product_forward</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv4N4dnnl21inner_product_forward14primitive_descE" title="dnnl::inner_product_forward::primitive_desc">primitive_desc</a> &amp;<em>pd</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4dnnl21inner_product_forward21inner_product_forwardERK14primitive_desc" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Constructs an inner product forward propagation primitive. <dl class="simple">
<dt><strong>Parameters</strong></dt><dd><ul class="breatheparameterlist simple">
<li><p><code class="docutils literal notranslate"><span class="pre">pd</span></code>: Primitive descriptor for an inner product forward propagation primitive. </p></li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

</div>
<dl class="cpp struct">
<dt id="_CPPv4N4dnnl21inner_product_forward4descE">
<span id="_CPPv3N4dnnl21inner_product_forward4descE"></span><span id="_CPPv2N4dnnl21inner_product_forward4descE"></span><span id="dnnl::inner_product_forward::desc"></span><span class="target" id="structdnnl_1_1inner__product__forward_1_1desc"></span><em class="property">struct </em><code class="sig-name descname">desc</code><a class="headerlink" href="#_CPPv4N4dnnl21inner_product_forward4descE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Descriptor for an inner product forward propagation primitive. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="cpp function">
<dt id="_CPPv4N4dnnl21inner_product_forward4desc4descE9prop_kindRKN6memory4descERKN6memory4descERKN6memory4descERKN6memory4descE">
<span id="_CPPv3N4dnnl21inner_product_forward4desc4descE9prop_kindRKN6memory4descERKN6memory4descERKN6memory4descERKN6memory4descE"></span><span id="_CPPv2N4dnnl21inner_product_forward4desc4descE9prop_kindRKN6memory4descERKN6memory4descERKN6memory4descERKN6memory4descE"></span><span id="dnnl::inner_product_forward::desc::desc__prop_kind.memory::descCR.memory::descCR.memory::descCR.memory::descCR"></span><span class="target" id="structdnnl_1_1inner__product__forward_1_1desc_1a30dfb10aad7d4a2ed19761ae454643f3"></span><code class="sig-name descname">desc</code><span class="sig-paren">(</span><a class="reference internal" href="general.html#_CPPv4N4dnnl9prop_kindE" title="dnnl::prop_kind">prop_kind</a> <em>aprop_kind</em>, <em class="property">const</em> <a class="reference internal" href="../data_model/memory/objects.html#_CPPv4N4dnnl6memoryE" title="dnnl::memory">memory</a>::<a class="reference internal" href="../data_model/memory/objects.html#_CPPv4N4dnnl6memory4descE" title="dnnl::memory::desc">desc</a> &amp;<em>src_desc</em>, <em class="property">const</em> <a class="reference internal" href="../data_model/memory/objects.html#_CPPv4N4dnnl6memoryE" title="dnnl::memory">memory</a>::<a class="reference internal" href="../data_model/memory/objects.html#_CPPv4N4dnnl6memory4descE" title="dnnl::memory::desc">desc</a> &amp;<em>weights_desc</em>, <em class="property">const</em> <a class="reference internal" href="../data_model/memory/objects.html#_CPPv4N4dnnl6memoryE" title="dnnl::memory">memory</a>::<a class="reference internal" href="../data_model/memory/objects.html#_CPPv4N4dnnl6memory4descE" title="dnnl::memory::desc">desc</a> &amp;<em>bias_desc</em>, <em class="property">const</em> <a class="reference internal" href="../data_model/memory/objects.html#_CPPv4N4dnnl6memoryE" title="dnnl::memory">memory</a>::<a class="reference internal" href="../data_model/memory/objects.html#_CPPv4N4dnnl6memory4descE" title="dnnl::memory::desc">desc</a> &amp;<em>dst_desc</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4dnnl21inner_product_forward4desc4descE9prop_kindRKN6memory4descERKN6memory4descERKN6memory4descERKN6memory4descE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Constructs a descriptor for an inner product forward propagation primitive with bias.</p>
<p><dl class="simple">
<dt><strong>Note</strong></dt><dd><p>All the memory descriptors may be initialized with the <a class="reference internal" href="../data_model/memory/formats.html#structdnnl_1_1memory_1a8e71077ed6a5f7fb7b3e6e1a5a2ecf3fa100b8cad7cf2a56f6df78f171f97a1ec"><span class="std std-ref">dnnl::memory::format_tag::any</span></a> value of <code class="docutils literal notranslate"><span class="pre">format_tag</span></code>.</p>
</dd>
<dt><strong>Parameters</strong></dt><dd><ul class="breatheparameterlist simple">
<li><p><code class="docutils literal notranslate"><span class="pre">aprop_kind</span></code>: Propagation kind. Possible values are <a class="reference internal" href="general.html#group__dnnl__api__attributes_1ggac7db48f6583aa9903e54c2a39d65438fa24775787fab8f13aa4809e1ce8f82aeb"><span class="std std-ref">dnnl::prop_kind::forward_training</span></a>, and <a class="reference internal" href="general.html#group__dnnl__api__attributes_1ggac7db48f6583aa9903e54c2a39d65438fa3b9fad4f80d45368f856b5403198ac4c"><span class="std std-ref">dnnl::prop_kind::forward_inference</span></a>. </p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">src_desc</span></code>: Memory descriptor for src. </p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">weights_desc</span></code>: Memory descriptor for diff weights. </p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bias_desc</span></code>: Memory descriptor for diff bias. </p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dst_desc</span></code>: Memory descriptor for diff dst. </p></li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="cpp function">
<dt id="_CPPv4N4dnnl21inner_product_forward4desc4descE9prop_kindRKN6memory4descERKN6memory4descERKN6memory4descE">
<span id="_CPPv3N4dnnl21inner_product_forward4desc4descE9prop_kindRKN6memory4descERKN6memory4descERKN6memory4descE"></span><span id="_CPPv2N4dnnl21inner_product_forward4desc4descE9prop_kindRKN6memory4descERKN6memory4descERKN6memory4descE"></span><span id="dnnl::inner_product_forward::desc::desc__prop_kind.memory::descCR.memory::descCR.memory::descCR"></span><span class="target" id="structdnnl_1_1inner__product__forward_1_1desc_1a26f9ccb7d914078d1eee94634025edfe"></span><code class="sig-name descname">desc</code><span class="sig-paren">(</span><a class="reference internal" href="general.html#_CPPv4N4dnnl9prop_kindE" title="dnnl::prop_kind">prop_kind</a> <em>aprop_kind</em>, <em class="property">const</em> <a class="reference internal" href="../data_model/memory/objects.html#_CPPv4N4dnnl6memoryE" title="dnnl::memory">memory</a>::<a class="reference internal" href="../data_model/memory/objects.html#_CPPv4N4dnnl6memory4descE" title="dnnl::memory::desc">desc</a> &amp;<em>src_desc</em>, <em class="property">const</em> <a class="reference internal" href="../data_model/memory/objects.html#_CPPv4N4dnnl6memoryE" title="dnnl::memory">memory</a>::<a class="reference internal" href="../data_model/memory/objects.html#_CPPv4N4dnnl6memory4descE" title="dnnl::memory::desc">desc</a> &amp;<em>weights_desc</em>, <em class="property">const</em> <a class="reference internal" href="../data_model/memory/objects.html#_CPPv4N4dnnl6memoryE" title="dnnl::memory">memory</a>::<a class="reference internal" href="../data_model/memory/objects.html#_CPPv4N4dnnl6memory4descE" title="dnnl::memory::desc">desc</a> &amp;<em>dst_desc</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4dnnl21inner_product_forward4desc4descE9prop_kindRKN6memory4descERKN6memory4descERKN6memory4descE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Constructs a descriptor for an inner product forward propagation primitive without bias.</p>
<p><dl class="simple">
<dt><strong>Note</strong></dt><dd><p>All the memory descriptors may be initialized with the <a class="reference internal" href="../data_model/memory/formats.html#structdnnl_1_1memory_1a8e71077ed6a5f7fb7b3e6e1a5a2ecf3fa100b8cad7cf2a56f6df78f171f97a1ec"><span class="std std-ref">dnnl::memory::format_tag::any</span></a> value of <code class="docutils literal notranslate"><span class="pre">format_tag</span></code>.</p>
</dd>
<dt><strong>Parameters</strong></dt><dd><ul class="breatheparameterlist simple">
<li><p><code class="docutils literal notranslate"><span class="pre">aprop_kind</span></code>: Propagation kind. Possible values are <a class="reference internal" href="general.html#group__dnnl__api__attributes_1ggac7db48f6583aa9903e54c2a39d65438fa24775787fab8f13aa4809e1ce8f82aeb"><span class="std std-ref">dnnl::prop_kind::forward_training</span></a>, and <a class="reference internal" href="general.html#group__dnnl__api__attributes_1ggac7db48f6583aa9903e54c2a39d65438fa3b9fad4f80d45368f856b5403198ac4c"><span class="std std-ref">dnnl::prop_kind::forward_inference</span></a>. </p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">src_desc</span></code>: Memory descriptor for src. </p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">weights_desc</span></code>: Memory descriptor for diff weights. </p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dst_desc</span></code>: Memory descriptor for dst. </p></li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp struct">
<dt id="_CPPv4N4dnnl21inner_product_forward14primitive_descE">
<span id="_CPPv3N4dnnl21inner_product_forward14primitive_descE"></span><span id="_CPPv2N4dnnl21inner_product_forward14primitive_descE"></span><span id="dnnl::inner_product_forward::primitive_desc"></span><span class="target" id="structdnnl_1_1inner__product__forward_1_1primitive__desc"></span><em class="property">struct </em><code class="sig-name descname">primitive_desc</code> : <em class="property">public</em> dnnl::<a class="reference internal" href="general.html#_CPPv4N4dnnl14primitive_descE" title="dnnl::primitive_desc">primitive_desc</a><a class="headerlink" href="#_CPPv4N4dnnl21inner_product_forward14primitive_descE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Primitive descriptor for an inner product forward propagation primitive. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="cpp function">
<dt id="_CPPv4N4dnnl21inner_product_forward14primitive_desc14primitive_descEv">
<span id="_CPPv3N4dnnl21inner_product_forward14primitive_desc14primitive_descEv"></span><span id="_CPPv2N4dnnl21inner_product_forward14primitive_desc14primitive_descEv"></span><span id="dnnl::inner_product_forward::primitive_desc::primitive_desc"></span><span class="target" id="structdnnl_1_1inner__product__forward_1_1primitive__desc_1a5991e19b0d0b81dd0bc6da4cd2e8b9f0"></span><code class="sig-name descname">primitive_desc</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4dnnl21inner_product_forward14primitive_desc14primitive_descEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Default constructor. Produces an empty object. </p>
</dd></dl>

<dl class="cpp function">
<dt id="_CPPv4N4dnnl21inner_product_forward14primitive_desc14primitive_descERK4descRK6engineb">
<span id="_CPPv3N4dnnl21inner_product_forward14primitive_desc14primitive_descERK4descRK6engineb"></span><span id="_CPPv2N4dnnl21inner_product_forward14primitive_desc14primitive_descERK4descRK6engineb"></span><span id="dnnl::inner_product_forward::primitive_desc::primitive_desc__descCR.engineCR.b"></span><span class="target" id="structdnnl_1_1inner__product__forward_1_1primitive__desc_1a1abb11411235a03fd9be8cbacccffdc5"></span><code class="sig-name descname">primitive_desc</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv4N4dnnl21inner_product_forward4descE" title="dnnl::inner_product_forward::desc">desc</a> &amp;<em>adesc</em>, <em class="property">const</em> <a class="reference internal" href="../execution_model/index.html#_CPPv4N4dnnl6engineE" title="dnnl::engine">engine</a> &amp;<em>aengine</em>, bool <em>allow_empty</em> = false<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4dnnl21inner_product_forward14primitive_desc14primitive_descERK4descRK6engineb" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Constructs a primitive descriptor for an inner product forward propagation primitive.</p>
<p><dl class="simple">
<dt><strong>Parameters</strong></dt><dd><ul class="breatheparameterlist simple">
<li><p><code class="docutils literal notranslate"><span class="pre">adesc</span></code>: Descriptor for an inner product forward propagation primitive. </p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">aengine</span></code>: Engine to use. </p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">allow_empty</span></code>: A flag signifying whether construction is allowed to fail without throwing an exception. In this case an empty object will be produced. This flag is optional and defaults to false. </p></li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="cpp function">
<dt id="_CPPv4N4dnnl21inner_product_forward14primitive_desc14primitive_descERK4descRK14primitive_attrRK6engineb">
<span id="_CPPv3N4dnnl21inner_product_forward14primitive_desc14primitive_descERK4descRK14primitive_attrRK6engineb"></span><span id="_CPPv2N4dnnl21inner_product_forward14primitive_desc14primitive_descERK4descRK14primitive_attrRK6engineb"></span><span id="dnnl::inner_product_forward::primitive_desc::primitive_desc__descCR.primitive_attrCR.engineCR.b"></span><span class="target" id="structdnnl_1_1inner__product__forward_1_1primitive__desc_1afb1f1458d90f1a1acb97dcf2ac332841"></span><code class="sig-name descname">primitive_desc</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv4N4dnnl21inner_product_forward4descE" title="dnnl::inner_product_forward::desc">desc</a> &amp;<em>adesc</em>, <em class="property">const</em> <a class="reference internal" href="attributes/index.html#_CPPv4N4dnnl14primitive_attrE" title="dnnl::primitive_attr">primitive_attr</a> &amp;<em>attr</em>, <em class="property">const</em> <a class="reference internal" href="../execution_model/index.html#_CPPv4N4dnnl6engineE" title="dnnl::engine">engine</a> &amp;<em>aengine</em>, bool <em>allow_empty</em> = false<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4dnnl21inner_product_forward14primitive_desc14primitive_descERK4descRK14primitive_attrRK6engineb" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Constructs a primitive descriptor for an inner product forward propagation primitive.</p>
<p><dl class="simple">
<dt><strong>Parameters</strong></dt><dd><ul class="breatheparameterlist simple">
<li><p><code class="docutils literal notranslate"><span class="pre">adesc</span></code>: Descriptor for an inner product forward propagation primitive. </p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">attr</span></code>: Primitive attributes to use. </p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">aengine</span></code>: Engine to use. </p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">allow_empty</span></code>: A flag signifying whether construction is allowed to fail without throwing an exception. In this case an empty object will be produced. This flag is optional and defaults to false. </p></li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="cpp function">
<dt id="_CPPv4NK4dnnl21inner_product_forward14primitive_desc8src_descEv">
<span id="_CPPv3NK4dnnl21inner_product_forward14primitive_desc8src_descEv"></span><span id="_CPPv2NK4dnnl21inner_product_forward14primitive_desc8src_descEv"></span><span id="dnnl::inner_product_forward::primitive_desc::src_descC"></span><span class="target" id="structdnnl_1_1inner__product__forward_1_1primitive__desc_1ae56e3be8da7215d6ac96030cf94dcb2a"></span><a class="reference internal" href="../data_model/memory/objects.html#_CPPv4N4dnnl6memoryE" title="dnnl::memory">memory</a>::<a class="reference internal" href="../data_model/memory/objects.html#_CPPv4N4dnnl6memory4descE" title="dnnl::memory::desc">desc</a> <code class="sig-name descname">src_desc</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv4NK4dnnl21inner_product_forward14primitive_desc8src_descEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns a source memory descriptor. <dl class="simple">
<dt><strong>Return</strong></dt><dd><p>Source memory descriptor. </p>
</dd>
<dt><strong>Return</strong></dt><dd><p>A zero memory descriptor if the primitive does not have a source parameter. </p>
</dd>
</dl>
</p>
</dd></dl>

<dl class="cpp function">
<dt id="_CPPv4NK4dnnl21inner_product_forward14primitive_desc12weights_descEv">
<span id="_CPPv3NK4dnnl21inner_product_forward14primitive_desc12weights_descEv"></span><span id="_CPPv2NK4dnnl21inner_product_forward14primitive_desc12weights_descEv"></span><span id="dnnl::inner_product_forward::primitive_desc::weights_descC"></span><span class="target" id="structdnnl_1_1inner__product__forward_1_1primitive__desc_1a987cf534713889f94347eaf75c744b8a"></span><a class="reference internal" href="../data_model/memory/objects.html#_CPPv4N4dnnl6memoryE" title="dnnl::memory">memory</a>::<a class="reference internal" href="../data_model/memory/objects.html#_CPPv4N4dnnl6memory4descE" title="dnnl::memory::desc">desc</a> <code class="sig-name descname">weights_desc</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv4NK4dnnl21inner_product_forward14primitive_desc12weights_descEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns a weights memory descriptor. <dl class="simple">
<dt><strong>Return</strong></dt><dd><p>Weights memory descriptor. </p>
</dd>
<dt><strong>Return</strong></dt><dd><p>A zero memory descriptor if the primitive does not have a weights parameter. </p>
</dd>
</dl>
</p>
</dd></dl>

<dl class="cpp function">
<dt id="_CPPv4NK4dnnl21inner_product_forward14primitive_desc8dst_descEv">
<span id="_CPPv3NK4dnnl21inner_product_forward14primitive_desc8dst_descEv"></span><span id="_CPPv2NK4dnnl21inner_product_forward14primitive_desc8dst_descEv"></span><span id="dnnl::inner_product_forward::primitive_desc::dst_descC"></span><span class="target" id="structdnnl_1_1inner__product__forward_1_1primitive__desc_1a186c88a9b62a2e34dc4e6b894083a602"></span><a class="reference internal" href="../data_model/memory/objects.html#_CPPv4N4dnnl6memoryE" title="dnnl::memory">memory</a>::<a class="reference internal" href="../data_model/memory/objects.html#_CPPv4N4dnnl6memory4descE" title="dnnl::memory::desc">desc</a> <code class="sig-name descname">dst_desc</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv4NK4dnnl21inner_product_forward14primitive_desc8dst_descEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns a destination memory descriptor. <dl class="simple">
<dt><strong>Return</strong></dt><dd><p>Destination memory descriptor. </p>
</dd>
<dt><strong>Return</strong></dt><dd><p>A zero memory descriptor if the primitive does not have a destination parameter. </p>
</dd>
</dl>
</p>
</dd></dl>

<dl class="cpp function">
<dt id="_CPPv4NK4dnnl21inner_product_forward14primitive_desc9bias_descEv">
<span id="_CPPv3NK4dnnl21inner_product_forward14primitive_desc9bias_descEv"></span><span id="_CPPv2NK4dnnl21inner_product_forward14primitive_desc9bias_descEv"></span><span id="dnnl::inner_product_forward::primitive_desc::bias_descC"></span><span class="target" id="structdnnl_1_1inner__product__forward_1_1primitive__desc_1ab0f8e32093d94d741adabd81451a0793"></span><a class="reference internal" href="../data_model/memory/objects.html#_CPPv4N4dnnl6memoryE" title="dnnl::memory">memory</a>::<a class="reference internal" href="../data_model/memory/objects.html#_CPPv4N4dnnl6memory4descE" title="dnnl::memory::desc">desc</a> <code class="sig-name descname">bias_desc</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv4NK4dnnl21inner_product_forward14primitive_desc9bias_descEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns the bias memory descriptor. <dl class="simple">
<dt><strong>Return</strong></dt><dd><p>The bias memory descriptor. </p>
</dd>
<dt><strong>Return</strong></dt><dd><p>A zero memory descriptor of the primitive does not have a bias parameter. </p>
</dd>
</dl>
</p>
</dd></dl>

</div>
</dd></dl>

</dd></dl>

<dl class="cpp struct">
<dt id="_CPPv4N4dnnl27inner_product_backward_dataE">
<span id="_CPPv3N4dnnl27inner_product_backward_dataE"></span><span id="_CPPv2N4dnnl27inner_product_backward_dataE"></span><span id="dnnl::inner_product_backward_data"></span><span class="target" id="structdnnl_1_1inner__product__backward__data"></span><em class="property">struct </em><code class="sig-prename descclassname">dnnl<code class="sig-prename descclassname">::</code></code><code class="sig-name descname">inner_product_backward_data</code> : <em class="property">public</em> dnnl::<a class="reference internal" href="general.html#_CPPv4N4dnnl9primitiveE" title="dnnl::primitive">primitive</a><a class="headerlink" href="#_CPPv4N4dnnl27inner_product_backward_dataE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Inner product backward propagation primitive. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="cpp function">
<dt id="_CPPv4N4dnnl27inner_product_backward_data27inner_product_backward_dataEv">
<span id="_CPPv3N4dnnl27inner_product_backward_data27inner_product_backward_dataEv"></span><span id="_CPPv2N4dnnl27inner_product_backward_data27inner_product_backward_dataEv"></span><span id="dnnl::inner_product_backward_data::inner_product_backward_data"></span><span class="target" id="structdnnl_1_1inner__product__backward__data_1a992d10d9af41f42585aa4f29ab7d5cda"></span><code class="sig-name descname">inner_product_backward_data</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4dnnl27inner_product_backward_data27inner_product_backward_dataEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Default constructor. Produces an empty object. </p>
</dd></dl>

<dl class="cpp function">
<dt id="_CPPv4N4dnnl27inner_product_backward_data27inner_product_backward_dataERK14primitive_desc">
<span id="_CPPv3N4dnnl27inner_product_backward_data27inner_product_backward_dataERK14primitive_desc"></span><span id="_CPPv2N4dnnl27inner_product_backward_data27inner_product_backward_dataERK14primitive_desc"></span><span id="dnnl::inner_product_backward_data::inner_product_backward_data__primitive_descCR"></span><span class="target" id="structdnnl_1_1inner__product__backward__data_1a5fe16e09062a20988dd5305c0410693d"></span><code class="sig-name descname">inner_product_backward_data</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv4N4dnnl27inner_product_backward_data14primitive_descE" title="dnnl::inner_product_backward_data::primitive_desc">primitive_desc</a> &amp;<em>pd</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4dnnl27inner_product_backward_data27inner_product_backward_dataERK14primitive_desc" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Constructs an inner product backward propagation primitive. <dl class="simple">
<dt><strong>Parameters</strong></dt><dd><ul class="breatheparameterlist simple">
<li><p><code class="docutils literal notranslate"><span class="pre">pd</span></code>: Primitive descriptor for an inner product backward propagation primitive. </p></li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

</div>
<dl class="cpp struct">
<dt id="_CPPv4N4dnnl27inner_product_backward_data4descE">
<span id="_CPPv3N4dnnl27inner_product_backward_data4descE"></span><span id="_CPPv2N4dnnl27inner_product_backward_data4descE"></span><span id="dnnl::inner_product_backward_data::desc"></span><span class="target" id="structdnnl_1_1inner__product__backward__data_1_1desc"></span><em class="property">struct </em><code class="sig-name descname">desc</code><a class="headerlink" href="#_CPPv4N4dnnl27inner_product_backward_data4descE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Descriptor for an inner product backward propagation primitive. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="cpp function">
<dt id="_CPPv4N4dnnl27inner_product_backward_data4desc4descERKN6memory4descERKN6memory4descERKN6memory4descE">
<span id="_CPPv3N4dnnl27inner_product_backward_data4desc4descERKN6memory4descERKN6memory4descERKN6memory4descE"></span><span id="_CPPv2N4dnnl27inner_product_backward_data4desc4descERKN6memory4descERKN6memory4descERKN6memory4descE"></span><span id="dnnl::inner_product_backward_data::desc::desc__memory::descCR.memory::descCR.memory::descCR"></span><span class="target" id="structdnnl_1_1inner__product__backward__data_1_1desc_1acb7a59b3dee40a7f67a388bbdd1d5a22"></span><code class="sig-name descname">desc</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="../data_model/memory/objects.html#_CPPv4N4dnnl6memoryE" title="dnnl::memory">memory</a>::<a class="reference internal" href="../data_model/memory/objects.html#_CPPv4N4dnnl6memory4descE" title="dnnl::memory::desc">desc</a> &amp;<em>diff_src_desc</em>, <em class="property">const</em> <a class="reference internal" href="../data_model/memory/objects.html#_CPPv4N4dnnl6memoryE" title="dnnl::memory">memory</a>::<a class="reference internal" href="../data_model/memory/objects.html#_CPPv4N4dnnl6memory4descE" title="dnnl::memory::desc">desc</a> &amp;<em>weights_desc</em>, <em class="property">const</em> <a class="reference internal" href="../data_model/memory/objects.html#_CPPv4N4dnnl6memoryE" title="dnnl::memory">memory</a>::<a class="reference internal" href="../data_model/memory/objects.html#_CPPv4N4dnnl6memory4descE" title="dnnl::memory::desc">desc</a> &amp;<em>diff_dst_desc</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4dnnl27inner_product_backward_data4desc4descERKN6memory4descERKN6memory4descERKN6memory4descE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Constructs a descriptor for an inner product backward propagation primitive.</p>
<p><dl class="simple">
<dt><strong>Note</strong></dt><dd><p>All the memory descriptors may be initialized with the <a class="reference internal" href="../data_model/memory/formats.html#structdnnl_1_1memory_1a8e71077ed6a5f7fb7b3e6e1a5a2ecf3fa100b8cad7cf2a56f6df78f171f97a1ec"><span class="std std-ref">dnnl::memory::format_tag::any</span></a> value of <code class="docutils literal notranslate"><span class="pre">format_tag</span></code>.</p>
</dd>
<dt><strong>Parameters</strong></dt><dd><ul class="breatheparameterlist simple">
<li><p><code class="docutils literal notranslate"><span class="pre">diff_src_desc</span></code>: Memory descriptor for diff src. </p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">weights_desc</span></code>: Memory descriptor for weights. </p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">diff_dst_desc</span></code>: Memory descriptor for diff dst. </p></li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp struct">
<dt id="_CPPv4N4dnnl27inner_product_backward_data14primitive_descE">
<span id="_CPPv3N4dnnl27inner_product_backward_data14primitive_descE"></span><span id="_CPPv2N4dnnl27inner_product_backward_data14primitive_descE"></span><span id="dnnl::inner_product_backward_data::primitive_desc"></span><span class="target" id="structdnnl_1_1inner__product__backward__data_1_1primitive__desc"></span><em class="property">struct </em><code class="sig-name descname">primitive_desc</code> : <em class="property">public</em> dnnl::<a class="reference internal" href="general.html#_CPPv4N4dnnl14primitive_descE" title="dnnl::primitive_desc">primitive_desc</a><a class="headerlink" href="#_CPPv4N4dnnl27inner_product_backward_data14primitive_descE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Primitive descriptor for an inner product backward propagation primitive. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="cpp function">
<dt id="_CPPv4N4dnnl27inner_product_backward_data14primitive_desc14primitive_descEv">
<span id="_CPPv3N4dnnl27inner_product_backward_data14primitive_desc14primitive_descEv"></span><span id="_CPPv2N4dnnl27inner_product_backward_data14primitive_desc14primitive_descEv"></span><span id="dnnl::inner_product_backward_data::primitive_desc::primitive_desc"></span><span class="target" id="structdnnl_1_1inner__product__backward__data_1_1primitive__desc_1aad500203655c6f7e852accedf4a71750"></span><code class="sig-name descname">primitive_desc</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4dnnl27inner_product_backward_data14primitive_desc14primitive_descEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Default constructor. Produces an empty object. </p>
</dd></dl>

<dl class="cpp function">
<dt id="_CPPv4N4dnnl27inner_product_backward_data14primitive_desc14primitive_descERK4descRK6engineRKN21inner_product_forward14primitive_descEb">
<span id="_CPPv3N4dnnl27inner_product_backward_data14primitive_desc14primitive_descERK4descRK6engineRKN21inner_product_forward14primitive_descEb"></span><span id="_CPPv2N4dnnl27inner_product_backward_data14primitive_desc14primitive_descERK4descRK6engineRKN21inner_product_forward14primitive_descEb"></span><span id="dnnl::inner_product_backward_data::primitive_desc::primitive_desc__descCR.engineCR.inner_product_forward::primitive_descCR.b"></span><span class="target" id="structdnnl_1_1inner__product__backward__data_1_1primitive__desc_1a3eba9e2479af5b8d9b125e1abbb35ca1"></span><code class="sig-name descname">primitive_desc</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv4N4dnnl27inner_product_backward_data4descE" title="dnnl::inner_product_backward_data::desc">desc</a> &amp;<em>adesc</em>, <em class="property">const</em> <a class="reference internal" href="../execution_model/index.html#_CPPv4N4dnnl6engineE" title="dnnl::engine">engine</a> &amp;<em>aengine</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv4N4dnnl21inner_product_forwardE" title="dnnl::inner_product_forward">inner_product_forward</a>::<a class="reference internal" href="#_CPPv4N4dnnl21inner_product_forward14primitive_descE" title="dnnl::inner_product_forward::primitive_desc">primitive_desc</a> &amp;<em>hint_fwd_pd</em>, bool <em>allow_empty</em> = false<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4dnnl27inner_product_backward_data14primitive_desc14primitive_descERK4descRK6engineRKN21inner_product_forward14primitive_descEb" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Constructs a primitive descriptor for an inner product backward propagation primitive.</p>
<p><dl class="simple">
<dt><strong>Parameters</strong></dt><dd><ul class="breatheparameterlist simple">
<li><p><code class="docutils literal notranslate"><span class="pre">adesc</span></code>: Descriptor for an inner product backward propagation primitive. </p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">aengine</span></code>: Engine to use. </p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hint_fwd_pd</span></code>: Primitive descriptor for an inner product forward propagation primitive. It is used as a hint for deciding which memory format to use. </p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">allow_empty</span></code>: A flag signifying whether construction is allowed to fail without throwing an exception. In this case an empty object will be produced. This flag is optional and defaults to false. </p></li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="cpp function">
<dt id="_CPPv4N4dnnl27inner_product_backward_data14primitive_desc14primitive_descERK4descRK14primitive_attrRK6engineRKN21inner_product_forward14primitive_descEb">
<span id="_CPPv3N4dnnl27inner_product_backward_data14primitive_desc14primitive_descERK4descRK14primitive_attrRK6engineRKN21inner_product_forward14primitive_descEb"></span><span id="_CPPv2N4dnnl27inner_product_backward_data14primitive_desc14primitive_descERK4descRK14primitive_attrRK6engineRKN21inner_product_forward14primitive_descEb"></span><span id="dnnl::inner_product_backward_data::primitive_desc::primitive_desc__descCR.primitive_attrCR.engineCR.inner_product_forward::primitive_descCR.b"></span><span class="target" id="structdnnl_1_1inner__product__backward__data_1_1primitive__desc_1a8f68251d7a1f20c219da1dc8da6c8a4d"></span><code class="sig-name descname">primitive_desc</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv4N4dnnl27inner_product_backward_data4descE" title="dnnl::inner_product_backward_data::desc">desc</a> &amp;<em>adesc</em>, <em class="property">const</em> <a class="reference internal" href="attributes/index.html#_CPPv4N4dnnl14primitive_attrE" title="dnnl::primitive_attr">primitive_attr</a> &amp;<em>attr</em>, <em class="property">const</em> <a class="reference internal" href="../execution_model/index.html#_CPPv4N4dnnl6engineE" title="dnnl::engine">engine</a> &amp;<em>aengine</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv4N4dnnl21inner_product_forwardE" title="dnnl::inner_product_forward">inner_product_forward</a>::<a class="reference internal" href="#_CPPv4N4dnnl21inner_product_forward14primitive_descE" title="dnnl::inner_product_forward::primitive_desc">primitive_desc</a> &amp;<em>hint_fwd_pd</em>, bool <em>allow_empty</em> = false<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4dnnl27inner_product_backward_data14primitive_desc14primitive_descERK4descRK14primitive_attrRK6engineRKN21inner_product_forward14primitive_descEb" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Constructs a primitive descriptor for an inner product backward propagation primitive.</p>
<p><dl class="simple">
<dt><strong>Parameters</strong></dt><dd><ul class="breatheparameterlist simple">
<li><p><code class="docutils literal notranslate"><span class="pre">adesc</span></code>: Descriptor for an inner product backward propagation primitive. </p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">attr</span></code>: Primitive attributes to use. </p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">aengine</span></code>: Engine to use. </p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hint_fwd_pd</span></code>: Primitive descriptor for an inner product forward propagation primitive. It is used as a hint for deciding which memory format to use. </p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">allow_empty</span></code>: A flag signifying whether construction is allowed to fail without throwing an exception. In this case an empty object will be produced. This flag is optional and defaults to false. </p></li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="cpp function">
<dt id="_CPPv4NK4dnnl27inner_product_backward_data14primitive_desc13diff_src_descEv">
<span id="_CPPv3NK4dnnl27inner_product_backward_data14primitive_desc13diff_src_descEv"></span><span id="_CPPv2NK4dnnl27inner_product_backward_data14primitive_desc13diff_src_descEv"></span><span id="dnnl::inner_product_backward_data::primitive_desc::diff_src_descC"></span><span class="target" id="structdnnl_1_1inner__product__backward__data_1_1primitive__desc_1ad6fec0ed82f4c500c9d561c0868f679d"></span><a class="reference internal" href="../data_model/memory/objects.html#_CPPv4N4dnnl6memoryE" title="dnnl::memory">memory</a>::<a class="reference internal" href="../data_model/memory/objects.html#_CPPv4N4dnnl6memory4descE" title="dnnl::memory::desc">desc</a> <code class="sig-name descname">diff_src_desc</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv4NK4dnnl27inner_product_backward_data14primitive_desc13diff_src_descEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns a diff source memory descriptor. <dl class="simple">
<dt><strong>Return</strong></dt><dd><p>Diff source memory descriptor. </p>
</dd>
<dt><strong>Return</strong></dt><dd><p>A zero memory descriptor if the primitive does not have a diff source memory with. </p>
</dd>
</dl>
</p>
</dd></dl>

<dl class="cpp function">
<dt id="_CPPv4NK4dnnl27inner_product_backward_data14primitive_desc12weights_descEv">
<span id="_CPPv3NK4dnnl27inner_product_backward_data14primitive_desc12weights_descEv"></span><span id="_CPPv2NK4dnnl27inner_product_backward_data14primitive_desc12weights_descEv"></span><span id="dnnl::inner_product_backward_data::primitive_desc::weights_descC"></span><span class="target" id="structdnnl_1_1inner__product__backward__data_1_1primitive__desc_1a523020039651b75ce9dbc9f2910ba38b"></span><a class="reference internal" href="../data_model/memory/objects.html#_CPPv4N4dnnl6memoryE" title="dnnl::memory">memory</a>::<a class="reference internal" href="../data_model/memory/objects.html#_CPPv4N4dnnl6memory4descE" title="dnnl::memory::desc">desc</a> <code class="sig-name descname">weights_desc</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv4NK4dnnl27inner_product_backward_data14primitive_desc12weights_descEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns a weights memory descriptor. <dl class="simple">
<dt><strong>Return</strong></dt><dd><p>Weights memory descriptor. </p>
</dd>
<dt><strong>Return</strong></dt><dd><p>A zero memory descriptor if the primitive does not have a weights parameter. </p>
</dd>
</dl>
</p>
</dd></dl>

<dl class="cpp function">
<dt id="_CPPv4NK4dnnl27inner_product_backward_data14primitive_desc13diff_dst_descEv">
<span id="_CPPv3NK4dnnl27inner_product_backward_data14primitive_desc13diff_dst_descEv"></span><span id="_CPPv2NK4dnnl27inner_product_backward_data14primitive_desc13diff_dst_descEv"></span><span id="dnnl::inner_product_backward_data::primitive_desc::diff_dst_descC"></span><span class="target" id="structdnnl_1_1inner__product__backward__data_1_1primitive__desc_1a2d18d8c7318a5fefa944879626db78c6"></span><a class="reference internal" href="../data_model/memory/objects.html#_CPPv4N4dnnl6memoryE" title="dnnl::memory">memory</a>::<a class="reference internal" href="../data_model/memory/objects.html#_CPPv4N4dnnl6memory4descE" title="dnnl::memory::desc">desc</a> <code class="sig-name descname">diff_dst_desc</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv4NK4dnnl27inner_product_backward_data14primitive_desc13diff_dst_descEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns a diff destination memory descriptor. <dl class="simple">
<dt><strong>Return</strong></dt><dd><p>Diff destination memory descriptor. </p>
</dd>
<dt><strong>Return</strong></dt><dd><p>A zero memory descriptor if the primitive does not have a diff destination parameter. </p>
</dd>
</dl>
</p>
</dd></dl>

</div>
</dd></dl>

</dd></dl>

<dl class="cpp struct">
<dt id="_CPPv4N4dnnl30inner_product_backward_weightsE">
<span id="_CPPv3N4dnnl30inner_product_backward_weightsE"></span><span id="_CPPv2N4dnnl30inner_product_backward_weightsE"></span><span id="dnnl::inner_product_backward_weights"></span><span class="target" id="structdnnl_1_1inner__product__backward__weights"></span><em class="property">struct </em><code class="sig-prename descclassname">dnnl<code class="sig-prename descclassname">::</code></code><code class="sig-name descname">inner_product_backward_weights</code> : <em class="property">public</em> dnnl::<a class="reference internal" href="general.html#_CPPv4N4dnnl9primitiveE" title="dnnl::primitive">primitive</a><a class="headerlink" href="#_CPPv4N4dnnl30inner_product_backward_weightsE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Inner product weights gradient primitive. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="cpp function">
<dt id="_CPPv4N4dnnl30inner_product_backward_weights30inner_product_backward_weightsEv">
<span id="_CPPv3N4dnnl30inner_product_backward_weights30inner_product_backward_weightsEv"></span><span id="_CPPv2N4dnnl30inner_product_backward_weights30inner_product_backward_weightsEv"></span><span id="dnnl::inner_product_backward_weights::inner_product_backward_weights"></span><span class="target" id="structdnnl_1_1inner__product__backward__weights_1ab208941d37032aa8ede2c12d63682322"></span><code class="sig-name descname">inner_product_backward_weights</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4dnnl30inner_product_backward_weights30inner_product_backward_weightsEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Default constructor. Produces an empty object. </p>
</dd></dl>

<dl class="cpp function">
<dt id="_CPPv4N4dnnl30inner_product_backward_weights30inner_product_backward_weightsERK14primitive_desc">
<span id="_CPPv3N4dnnl30inner_product_backward_weights30inner_product_backward_weightsERK14primitive_desc"></span><span id="_CPPv2N4dnnl30inner_product_backward_weights30inner_product_backward_weightsERK14primitive_desc"></span><span id="dnnl::inner_product_backward_weights::inner_product_backward_weights__primitive_descCR"></span><span class="target" id="structdnnl_1_1inner__product__backward__weights_1a5f050012a7044d8cb694dbd1382ba3ae"></span><code class="sig-name descname">inner_product_backward_weights</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv4N4dnnl30inner_product_backward_weights14primitive_descE" title="dnnl::inner_product_backward_weights::primitive_desc">primitive_desc</a> &amp;<em>pd</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4dnnl30inner_product_backward_weights30inner_product_backward_weightsERK14primitive_desc" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Constructs an inner product weights gradient primitive. <dl class="simple">
<dt><strong>Parameters</strong></dt><dd><ul class="breatheparameterlist simple">
<li><p><code class="docutils literal notranslate"><span class="pre">pd</span></code>: Primitive descriptor for an inner product weights gradient primitive. </p></li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

</div>
<dl class="cpp struct">
<dt id="_CPPv4N4dnnl30inner_product_backward_weights4descE">
<span id="_CPPv3N4dnnl30inner_product_backward_weights4descE"></span><span id="_CPPv2N4dnnl30inner_product_backward_weights4descE"></span><span id="dnnl::inner_product_backward_weights::desc"></span><span class="target" id="structdnnl_1_1inner__product__backward__weights_1_1desc"></span><em class="property">struct </em><code class="sig-name descname">desc</code><a class="headerlink" href="#_CPPv4N4dnnl30inner_product_backward_weights4descE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Descriptor for an inner product weights gradient primitive. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="cpp function">
<dt id="_CPPv4N4dnnl30inner_product_backward_weights4desc4descERKN6memory4descERKN6memory4descERKN6memory4descERKN6memory4descE">
<span id="_CPPv3N4dnnl30inner_product_backward_weights4desc4descERKN6memory4descERKN6memory4descERKN6memory4descERKN6memory4descE"></span><span id="_CPPv2N4dnnl30inner_product_backward_weights4desc4descERKN6memory4descERKN6memory4descERKN6memory4descERKN6memory4descE"></span><span id="dnnl::inner_product_backward_weights::desc::desc__memory::descCR.memory::descCR.memory::descCR.memory::descCR"></span><span class="target" id="structdnnl_1_1inner__product__backward__weights_1_1desc_1a08da17f4f460b7613d8c6143f984f941"></span><code class="sig-name descname">desc</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="../data_model/memory/objects.html#_CPPv4N4dnnl6memoryE" title="dnnl::memory">memory</a>::<a class="reference internal" href="../data_model/memory/objects.html#_CPPv4N4dnnl6memory4descE" title="dnnl::memory::desc">desc</a> &amp;<em>src_desc</em>, <em class="property">const</em> <a class="reference internal" href="../data_model/memory/objects.html#_CPPv4N4dnnl6memoryE" title="dnnl::memory">memory</a>::<a class="reference internal" href="../data_model/memory/objects.html#_CPPv4N4dnnl6memory4descE" title="dnnl::memory::desc">desc</a> &amp;<em>diff_weights_desc</em>, <em class="property">const</em> <a class="reference internal" href="../data_model/memory/objects.html#_CPPv4N4dnnl6memoryE" title="dnnl::memory">memory</a>::<a class="reference internal" href="../data_model/memory/objects.html#_CPPv4N4dnnl6memory4descE" title="dnnl::memory::desc">desc</a> &amp;<em>diff_bias_desc</em>, <em class="property">const</em> <a class="reference internal" href="../data_model/memory/objects.html#_CPPv4N4dnnl6memoryE" title="dnnl::memory">memory</a>::<a class="reference internal" href="../data_model/memory/objects.html#_CPPv4N4dnnl6memory4descE" title="dnnl::memory::desc">desc</a> &amp;<em>diff_dst_desc</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4dnnl30inner_product_backward_weights4desc4descERKN6memory4descERKN6memory4descERKN6memory4descERKN6memory4descE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Constructs a descriptor for an inner product descriptor weights update primitive with bias.</p>
<p><dl class="simple">
<dt><strong>Note</strong></dt><dd><p>All the memory descriptors may be initialized with the <a class="reference internal" href="../data_model/memory/formats.html#structdnnl_1_1memory_1a8e71077ed6a5f7fb7b3e6e1a5a2ecf3fa100b8cad7cf2a56f6df78f171f97a1ec"><span class="std std-ref">dnnl::memory::format_tag::any</span></a> value of <code class="docutils literal notranslate"><span class="pre">format_tag</span></code>.</p>
</dd>
<dt><strong>Parameters</strong></dt><dd><ul class="breatheparameterlist simple">
<li><p><code class="docutils literal notranslate"><span class="pre">src_desc</span></code>: Memory descriptor for src. </p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">diff_weights_desc</span></code>: Memory descriptor for diff weights. </p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">diff_bias_desc</span></code>: Memory descriptor for diff bias. </p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">diff_dst_desc</span></code>: Memory descriptor for diff dst. </p></li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="cpp function">
<dt id="_CPPv4N4dnnl30inner_product_backward_weights4desc4descERKN6memory4descERKN6memory4descERKN6memory4descE">
<span id="_CPPv3N4dnnl30inner_product_backward_weights4desc4descERKN6memory4descERKN6memory4descERKN6memory4descE"></span><span id="_CPPv2N4dnnl30inner_product_backward_weights4desc4descERKN6memory4descERKN6memory4descERKN6memory4descE"></span><span id="dnnl::inner_product_backward_weights::desc::desc__memory::descCR.memory::descCR.memory::descCR"></span><span class="target" id="structdnnl_1_1inner__product__backward__weights_1_1desc_1aec714169ef02d38afdd353a3962387ea"></span><code class="sig-name descname">desc</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="../data_model/memory/objects.html#_CPPv4N4dnnl6memoryE" title="dnnl::memory">memory</a>::<a class="reference internal" href="../data_model/memory/objects.html#_CPPv4N4dnnl6memory4descE" title="dnnl::memory::desc">desc</a> &amp;<em>src_desc</em>, <em class="property">const</em> <a class="reference internal" href="../data_model/memory/objects.html#_CPPv4N4dnnl6memoryE" title="dnnl::memory">memory</a>::<a class="reference internal" href="../data_model/memory/objects.html#_CPPv4N4dnnl6memory4descE" title="dnnl::memory::desc">desc</a> &amp;<em>diff_weights_desc</em>, <em class="property">const</em> <a class="reference internal" href="../data_model/memory/objects.html#_CPPv4N4dnnl6memoryE" title="dnnl::memory">memory</a>::<a class="reference internal" href="../data_model/memory/objects.html#_CPPv4N4dnnl6memory4descE" title="dnnl::memory::desc">desc</a> &amp;<em>diff_dst_desc</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4dnnl30inner_product_backward_weights4desc4descERKN6memory4descERKN6memory4descERKN6memory4descE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Constructs a descriptor for an inner product descriptor weights update primitive without bias.</p>
<p><dl class="simple">
<dt><strong>Note</strong></dt><dd><p>All the memory descriptors may be initialized with the <a class="reference internal" href="../data_model/memory/formats.html#structdnnl_1_1memory_1a8e71077ed6a5f7fb7b3e6e1a5a2ecf3fa100b8cad7cf2a56f6df78f171f97a1ec"><span class="std std-ref">dnnl::memory::format_tag::any</span></a> value of <code class="docutils literal notranslate"><span class="pre">format_tag</span></code>.</p>
</dd>
<dt><strong>Parameters</strong></dt><dd><ul class="breatheparameterlist simple">
<li><p><code class="docutils literal notranslate"><span class="pre">src_desc</span></code>: Memory descriptor for src. </p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">diff_weights_desc</span></code>: Memory descriptor for diff weights. </p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">diff_dst_desc</span></code>: Memory descriptor for diff dst. </p></li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp struct">
<dt id="_CPPv4N4dnnl30inner_product_backward_weights14primitive_descE">
<span id="_CPPv3N4dnnl30inner_product_backward_weights14primitive_descE"></span><span id="_CPPv2N4dnnl30inner_product_backward_weights14primitive_descE"></span><span id="dnnl::inner_product_backward_weights::primitive_desc"></span><span class="target" id="structdnnl_1_1inner__product__backward__weights_1_1primitive__desc"></span><em class="property">struct </em><code class="sig-name descname">primitive_desc</code> : <em class="property">public</em> dnnl::<a class="reference internal" href="general.html#_CPPv4N4dnnl14primitive_descE" title="dnnl::primitive_desc">primitive_desc</a><a class="headerlink" href="#_CPPv4N4dnnl30inner_product_backward_weights14primitive_descE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Primitive descriptor for an inner product weights gradient primitive. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="cpp function">
<dt id="_CPPv4N4dnnl30inner_product_backward_weights14primitive_desc14primitive_descEv">
<span id="_CPPv3N4dnnl30inner_product_backward_weights14primitive_desc14primitive_descEv"></span><span id="_CPPv2N4dnnl30inner_product_backward_weights14primitive_desc14primitive_descEv"></span><span id="dnnl::inner_product_backward_weights::primitive_desc::primitive_desc"></span><span class="target" id="structdnnl_1_1inner__product__backward__weights_1_1primitive__desc_1a09fae3c61b39f35eb69f2e7d1e0b7e5e"></span><code class="sig-name descname">primitive_desc</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4dnnl30inner_product_backward_weights14primitive_desc14primitive_descEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Default constructor. Produces an empty object. </p>
</dd></dl>

<dl class="cpp function">
<dt id="_CPPv4N4dnnl30inner_product_backward_weights14primitive_desc14primitive_descERK4descRK6engineRKN21inner_product_forward14primitive_descEb">
<span id="_CPPv3N4dnnl30inner_product_backward_weights14primitive_desc14primitive_descERK4descRK6engineRKN21inner_product_forward14primitive_descEb"></span><span id="_CPPv2N4dnnl30inner_product_backward_weights14primitive_desc14primitive_descERK4descRK6engineRKN21inner_product_forward14primitive_descEb"></span><span id="dnnl::inner_product_backward_weights::primitive_desc::primitive_desc__descCR.engineCR.inner_product_forward::primitive_descCR.b"></span><span class="target" id="structdnnl_1_1inner__product__backward__weights_1_1primitive__desc_1ab820c715e2b400030753cb81b2a2cd07"></span><code class="sig-name descname">primitive_desc</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv4N4dnnl30inner_product_backward_weights4descE" title="dnnl::inner_product_backward_weights::desc">desc</a> &amp;<em>adesc</em>, <em class="property">const</em> <a class="reference internal" href="../execution_model/index.html#_CPPv4N4dnnl6engineE" title="dnnl::engine">engine</a> &amp;<em>aengine</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv4N4dnnl21inner_product_forwardE" title="dnnl::inner_product_forward">inner_product_forward</a>::<a class="reference internal" href="#_CPPv4N4dnnl21inner_product_forward14primitive_descE" title="dnnl::inner_product_forward::primitive_desc">primitive_desc</a> &amp;<em>hint_fwd_pd</em>, bool <em>allow_empty</em> = false<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4dnnl30inner_product_backward_weights14primitive_desc14primitive_descERK4descRK6engineRKN21inner_product_forward14primitive_descEb" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Constructs a primitive descriptor for an inner product weights update primitive.</p>
<p><dl class="simple">
<dt><strong>Parameters</strong></dt><dd><ul class="breatheparameterlist simple">
<li><p><code class="docutils literal notranslate"><span class="pre">adesc</span></code>: Descriptor for an inner product weights gradient primitive. </p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">aengine</span></code>: Engine to use. </p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hint_fwd_pd</span></code>: Primitive descriptor for an inner product forward propagation primitive. It is used as a hint for deciding which memory format to use. </p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">allow_empty</span></code>: A flag signifying whether construction is allowed to fail without throwing an exception. In this case an empty object will be produced. This flag is optional and defaults to false. </p></li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="cpp function">
<dt id="_CPPv4N4dnnl30inner_product_backward_weights14primitive_desc14primitive_descERK4descRK14primitive_attrRK6engineRKN21inner_product_forward14primitive_descEb">
<span id="_CPPv3N4dnnl30inner_product_backward_weights14primitive_desc14primitive_descERK4descRK14primitive_attrRK6engineRKN21inner_product_forward14primitive_descEb"></span><span id="_CPPv2N4dnnl30inner_product_backward_weights14primitive_desc14primitive_descERK4descRK14primitive_attrRK6engineRKN21inner_product_forward14primitive_descEb"></span><span id="dnnl::inner_product_backward_weights::primitive_desc::primitive_desc__descCR.primitive_attrCR.engineCR.inner_product_forward::primitive_descCR.b"></span><span class="target" id="structdnnl_1_1inner__product__backward__weights_1_1primitive__desc_1a9a0964a42008a360f5b7ef452aea8f6c"></span><code class="sig-name descname">primitive_desc</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="#_CPPv4N4dnnl30inner_product_backward_weights4descE" title="dnnl::inner_product_backward_weights::desc">desc</a> &amp;<em>adesc</em>, <em class="property">const</em> <a class="reference internal" href="attributes/index.html#_CPPv4N4dnnl14primitive_attrE" title="dnnl::primitive_attr">primitive_attr</a> &amp;<em>attr</em>, <em class="property">const</em> <a class="reference internal" href="../execution_model/index.html#_CPPv4N4dnnl6engineE" title="dnnl::engine">engine</a> &amp;<em>aengine</em>, <em class="property">const</em> <a class="reference internal" href="#_CPPv4N4dnnl21inner_product_forwardE" title="dnnl::inner_product_forward">inner_product_forward</a>::<a class="reference internal" href="#_CPPv4N4dnnl21inner_product_forward14primitive_descE" title="dnnl::inner_product_forward::primitive_desc">primitive_desc</a> &amp;<em>hint_fwd_pd</em>, bool <em>allow_empty</em> = false<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4dnnl30inner_product_backward_weights14primitive_desc14primitive_descERK4descRK14primitive_attrRK6engineRKN21inner_product_forward14primitive_descEb" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Constructs a primitive descriptor for an inner product weights update primitive.</p>
<p><dl class="simple">
<dt><strong>Parameters</strong></dt><dd><ul class="breatheparameterlist simple">
<li><p><code class="docutils literal notranslate"><span class="pre">adesc</span></code>: Descriptor for an inner product weights gradient primitive. </p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">attr</span></code>: Primitive attributes to use. </p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">aengine</span></code>: Engine to use. </p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hint_fwd_pd</span></code>: Primitive descriptor for an inner product forward propagation primitive. It is used as a hint for deciding which memory format to use. </p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">allow_empty</span></code>: A flag signifying whether construction is allowed to fail without throwing an exception. In this case an empty object will be produced. This flag is optional and defaults to false. </p></li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="cpp function">
<dt id="_CPPv4NK4dnnl30inner_product_backward_weights14primitive_desc8src_descEv">
<span id="_CPPv3NK4dnnl30inner_product_backward_weights14primitive_desc8src_descEv"></span><span id="_CPPv2NK4dnnl30inner_product_backward_weights14primitive_desc8src_descEv"></span><span id="dnnl::inner_product_backward_weights::primitive_desc::src_descC"></span><span class="target" id="structdnnl_1_1inner__product__backward__weights_1_1primitive__desc_1a0a4f40fadb88bd6603b9121b7426fb51"></span><a class="reference internal" href="../data_model/memory/objects.html#_CPPv4N4dnnl6memoryE" title="dnnl::memory">memory</a>::<a class="reference internal" href="../data_model/memory/objects.html#_CPPv4N4dnnl6memory4descE" title="dnnl::memory::desc">desc</a> <code class="sig-name descname">src_desc</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv4NK4dnnl30inner_product_backward_weights14primitive_desc8src_descEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns a source memory descriptor. <dl class="simple">
<dt><strong>Return</strong></dt><dd><p>Source memory descriptor. </p>
</dd>
<dt><strong>Return</strong></dt><dd><p>A zero memory descriptor if the primitive does not have a source parameter. </p>
</dd>
</dl>
</p>
</dd></dl>

<dl class="cpp function">
<dt id="_CPPv4NK4dnnl30inner_product_backward_weights14primitive_desc17diff_weights_descEv">
<span id="_CPPv3NK4dnnl30inner_product_backward_weights14primitive_desc17diff_weights_descEv"></span><span id="_CPPv2NK4dnnl30inner_product_backward_weights14primitive_desc17diff_weights_descEv"></span><span id="dnnl::inner_product_backward_weights::primitive_desc::diff_weights_descC"></span><span class="target" id="structdnnl_1_1inner__product__backward__weights_1_1primitive__desc_1a46ac4299a91d79986c6fb7d905e0f00b"></span><a class="reference internal" href="../data_model/memory/objects.html#_CPPv4N4dnnl6memoryE" title="dnnl::memory">memory</a>::<a class="reference internal" href="../data_model/memory/objects.html#_CPPv4N4dnnl6memory4descE" title="dnnl::memory::desc">desc</a> <code class="sig-name descname">diff_weights_desc</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv4NK4dnnl30inner_product_backward_weights14primitive_desc17diff_weights_descEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns a diff weights memory descriptor. <dl class="simple">
<dt><strong>Return</strong></dt><dd><p>Diff weights memory descriptor. </p>
</dd>
<dt><strong>Return</strong></dt><dd><p>A zero memory descriptor if the primitive does not have a diff weights parameter. </p>
</dd>
</dl>
</p>
</dd></dl>

<dl class="cpp function">
<dt id="_CPPv4NK4dnnl30inner_product_backward_weights14primitive_desc13diff_dst_descEv">
<span id="_CPPv3NK4dnnl30inner_product_backward_weights14primitive_desc13diff_dst_descEv"></span><span id="_CPPv2NK4dnnl30inner_product_backward_weights14primitive_desc13diff_dst_descEv"></span><span id="dnnl::inner_product_backward_weights::primitive_desc::diff_dst_descC"></span><span class="target" id="structdnnl_1_1inner__product__backward__weights_1_1primitive__desc_1a70b4d3e444dc173602b87cc76999b171"></span><a class="reference internal" href="../data_model/memory/objects.html#_CPPv4N4dnnl6memoryE" title="dnnl::memory">memory</a>::<a class="reference internal" href="../data_model/memory/objects.html#_CPPv4N4dnnl6memory4descE" title="dnnl::memory::desc">desc</a> <code class="sig-name descname">diff_dst_desc</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv4NK4dnnl30inner_product_backward_weights14primitive_desc13diff_dst_descEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns a diff destination memory descriptor. <dl class="simple">
<dt><strong>Return</strong></dt><dd><p>Diff destination memory descriptor. </p>
</dd>
<dt><strong>Return</strong></dt><dd><p>A zero memory descriptor if the primitive does not have a diff destination parameter. </p>
</dd>
</dl>
</p>
</dd></dl>

<dl class="cpp function">
<dt id="_CPPv4NK4dnnl30inner_product_backward_weights14primitive_desc14diff_bias_descEv">
<span id="_CPPv3NK4dnnl30inner_product_backward_weights14primitive_desc14diff_bias_descEv"></span><span id="_CPPv2NK4dnnl30inner_product_backward_weights14primitive_desc14diff_bias_descEv"></span><span id="dnnl::inner_product_backward_weights::primitive_desc::diff_bias_descC"></span><span class="target" id="structdnnl_1_1inner__product__backward__weights_1_1primitive__desc_1ab68ee3171f06000cf006ab486d219f13"></span><a class="reference internal" href="../data_model/memory/objects.html#_CPPv4N4dnnl6memoryE" title="dnnl::memory">memory</a>::<a class="reference internal" href="../data_model/memory/objects.html#_CPPv4N4dnnl6memory4descE" title="dnnl::memory::desc">desc</a> <code class="sig-name descname">diff_bias_desc</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv4NK4dnnl30inner_product_backward_weights14primitive_desc14diff_bias_descEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns the diff bias memory descriptor. <dl class="simple">
<dt><strong>Return</strong></dt><dd><p>The diff bias memory descriptor. </p>
</dd>
<dt><strong>Return</strong></dt><dd><p>A zero memory descriptor of the primitive does not have a diff bias parameter. </p>
</dd>
</dl>
</p>
</dd></dl>

</div>
</dd></dl>

</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="layer_normalization.html" class="btn btn-neutral float-right" title="Layer normalization" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="eltwise.html" class="btn btn-neutral float-left" title="Elementwise" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Intel Corporation

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>